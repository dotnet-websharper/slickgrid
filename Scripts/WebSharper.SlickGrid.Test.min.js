var wsbundle=(()=>{var vt=Symbol("force");var se=globalThis.WebSharperRuntime||{ScriptBasePath:"./",ScriptSkipAssemblyDir:!1};globalThis.WebSharperRuntime=se;var oe=se;var Ce=Object.defineProperty,ve=(e,t,i)=>t in e?Ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,n=(e,t,i)=>ve(e,typeof t!="symbol"?t+"":t,i),B=class{constructor(e,t){this.event=e,this.args=t,n(this,"_isPropagationStopped",!1),n(this,"_isImmediatePropagationStopped",!1),n(this,"_isDefaultPrevented",!1),n(this,"returnValues",[]),n(this,"returnValue"),n(this,"_eventTarget"),n(this,"nativeEvent"),n(this,"arguments_"),n(this,"altKey"),n(this,"ctrlKey"),n(this,"metaKey"),n(this,"shiftKey"),n(this,"key"),n(this,"keyCode"),n(this,"clientX"),n(this,"clientY"),n(this,"offsetX"),n(this,"offsetY"),n(this,"pageX"),n(this,"pageY"),n(this,"bubbles"),n(this,"target"),n(this,"type"),n(this,"which"),n(this,"x"),n(this,"y"),this.nativeEvent=e,this.arguments_=t,e&&["altKey","ctrlKey","metaKey","shiftKey","key","keyCode","clientX","clientY","offsetX","offsetY","pageX","pageY","bubbles","target","type","which","x","y"].forEach(i=>this[i]=e[i]),this._eventTarget=this.nativeEvent?this.nativeEvent.target:void 0}get defaultPrevented(){return this._isDefaultPrevented}stopPropagation(){this._isPropagationStopped=!0,this.nativeEvent?.stopPropagation()}isPropagationStopped(){return this._isPropagationStopped}stopImmediatePropagation(){this._isImmediatePropagationStopped=!0,this.nativeEvent&&this.nativeEvent.stopImmediatePropagation()}isImmediatePropagationStopped(){return this._isImmediatePropagationStopped}getNativeEvent(){return this.nativeEvent}preventDefault(){this.nativeEvent&&this.nativeEvent.preventDefault(),this._isDefaultPrevented=!0}isDefaultPrevented(){return this.nativeEvent?this.nativeEvent.defaultPrevented:this._isDefaultPrevented}addReturnValue(e){this.returnValues.push(e),this.returnValue===void 0&&e!==void 0&&(this.returnValue=e)}getReturnValue(){return this.returnValue}getArguments(){return this.arguments_}},Y=class{constructor(e,t){this.eventName=e,this.pubSub=t,n(this,"_handlers",[]),n(this,"_pubSubService"),this._pubSubService=t}get subscriberCount(){return this._handlers.length}subscribe(e){this._handlers.push(e)}unsubscribe(e){for(let t=this._handlers.length-1;t>=0;t--)this._handlers[t]===e&&this._handlers.splice(t,1)}notify(e,t,i){let s=t instanceof B?t:new B(t,e);i=i||this;for(let o=0;o<this._handlers.length&&!(s.isPropagationStopped()||s.isImmediatePropagationStopped());o++){let l=this._handlers[o].call(i,s,e);s.addReturnValue(l)}if(typeof this._pubSubService?.publish=="function"&&this.eventName){let o=this._pubSubService.publish(this.eventName,{args:e,eventData:s});s.addReturnValue(o)}return s}setPubSubService(e){this._pubSubService=e}},be=class{constructor(){n(this,"handlers",[])}subscribe(e,t){return this.handlers.push({event:e,handler:t}),e.subscribe(t),this}unsubscribe(e,t){let i=this.handlers.length;for(;i--;)if(this.handlers[i].event===e&&this.handlers[i].handler===t){this.handlers.splice(i,1),e.unsubscribe(t);return}return this}unsubscribeAll(){let e=this.handlers.length;for(;e--;)this.handlers[e].event.unsubscribe(this.handlers[e].handler);return this.handlers=[],this}},ce=class{constructor(e,t,i,s){n(this,"fromRow"),n(this,"fromCell"),n(this,"toCell"),n(this,"toRow"),i===void 0&&s===void 0&&(i=e,s=t),this.fromRow=Math.min(e,i),this.fromCell=Math.min(t,s),this.toCell=Math.max(t,s),this.toRow=Math.max(e,i)}isSingleRow(){return this.fromRow===this.toRow}isSingleCell(){return this.fromRow===this.toRow&&this.fromCell===this.toCell}rowCount(){return this.toRow-this.fromRow+1}cellCount(){return this.toCell-this.fromCell+1}contains(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell}toString(){return this.isSingleCell()?`(${this.fromRow}:${this.fromCell})`:`(${this.fromRow}:${this.fromCell} - ${this.toRow}:${this.toCell})`}},ye=class{constructor(e,t,i,s){n(this,"fromRow"),n(this,"fromCell"),n(this,"rowCount"),n(this,"cellCount"),this.fromRow=e,this.fromCell=t,this.rowCount=i,this.cellCount=s}},Se=class{constructor(e){n(this,"id"),n(this,"cssClass","slick-drag-replace-handle"),this.id=`${e}_drag_replace_handle`}removeEl(){document.getElementById(this.id)?.remove()}createEl(e){if(e){let t=document.createElement("div");t.classList.add("slick-drag-replace-handle"),t.id=this.id,e.appendChild(t)}}},Z=class{constructor(){n(this,"__nonDataRow",!0)}},Re=class extends Z{constructor(){super(),n(this,"__group",!0),n(this,"level",0),n(this,"count",0),n(this,"value",null),n(this,"title",null),n(this,"collapsed",!1),n(this,"selectChecked",!1),n(this,"totals",null),n(this,"rows",[]),n(this,"groups",null),n(this,"groupingKey",null)}equals(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title}},Ee=class extends Z{constructor(){super(),n(this,"__groupTotals",!0),n(this,"group",null),n(this,"initialized",!1)}},ue=class{constructor(){n(this,"activeEditController",null)}isActive(e){return e?this.activeEditController===e:this.activeEditController!==null}activate(e){if(e!==this.activeEditController){if(this.activeEditController!==null)throw new Error("Slick.EditorLock.activate: an editController is still active, can't activate another editController");if(!e.commitCurrentEdit)throw new Error("Slick.EditorLock.activate: editController must implement .commitCurrentEdit()");if(!e.cancelCurrentEdit)throw new Error("Slick.EditorLock.activate: editController must implement .cancelCurrentEdit()");this.activeEditController=e}}deactivate(e){if(this.activeEditController){if(this.activeEditController!==e)throw new Error("Slick.EditorLock.deactivate: specified editController is not the currently active one");this.activeEditController=null}}commitCurrentEdit(){return this.activeEditController?this.activeEditController.commitCurrentEdit():!0}cancelCurrentEdit(){return this.activeEditController?this.activeEditController.cancelCurrentEdit():!0}};function ke(e){return e.replace(/(\b)(on[a-z]+)(\s*)=|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;)(\/*)(script|script defer)(.*)(&gt;|&gt;">)/gi,"")}var xe=class{constructor(){n(this,"_boundedEvents",[])}getBoundedEvents(){return this._boundedEvents}destroy(){this.unbindAll()}bind(e,t,i,s,o=""){e&&(e.addEventListener(t,i,s),this._boundedEvents.push({element:e,eventName:t,listener:i,groupName:o}))}unbind(e,t,i){e?.removeEventListener&&e.removeEventListener(t,i)}unbindByEventName(e,t){let i=this._boundedEvents.find(s=>s.element===e&&s.eventName===t);i&&this.unbind(i.element,i.eventName,i.listener)}unbindAll(e){if(e){let t=Array.isArray(e)?e:[e];for(let i=this._boundedEvents.length-1;i>=0;--i){let s=this._boundedEvents[i];if(t.some(o=>o===s.groupName)){let{element:o,eventName:l,listener:a}=s;this.unbind(o,l,a),this._boundedEvents.splice(i,1)}}}else for(;this._boundedEvents.length>0;){let t=this._boundedEvents.pop(),{element:i,eventName:s,listener:o}=t;this.unbind(i,s,o)}}},M=class x{static isFunction(t){return typeof t=="function"&&typeof t.nodeType!="number"&&typeof t.item!="function"}static isPlainObject(t){if(!t||x.toString.call(t)!=="[object Object]")return!1;let i=x.getProto(t);if(!i)return!0;let s=x.hasOwn.call(i,"constructor")&&i.constructor;return typeof s=="function"&&x.fnToString.call(s)===x.ObjectFunctionString}static calculateAvailableSpace(t){let i=0,s=0,o=0,l=0,a=window.innerHeight||0,h=window.innerWidth||0,u=x.windowScrollPosition(),d=u.top,p=u.left,c=x.offset(t);if(c){let m=c.top||0,f=c.left||0;s=m-d,i=a-(m-d),o=f-p,l=h-(f-p)}return{top:s,bottom:i,left:o,right:l}}static extend(...t){let i,s,o,l,a,h,u=t[0],d=1,p=!1,c=t.length;for(typeof u=="boolean"?(p=u,u=t[d]||{},d++):u=u||{},typeof u!="object"&&!x.isFunction(u)&&(u={}),d===c&&(u=this,d--);d<c;d++)if(x.isDefined(i=t[d]))for(s in i)l=i[s],!(s==="__proto__"||u===l)&&(p&&l&&(x.isPlainObject(l)||(a=Array.isArray(l)))?(o=u[s],a&&!Array.isArray(o)?h=[]:!a&&!x.isPlainObject(o)?h={}:h=o,a=!1,u[s]=x.extend(p,h,l)):l!==void 0&&(u[s]=l));return u}static createDomElement(t,i,s){let o=document.createElement(t);return i&&Object.keys(i).forEach(l=>{l==="innerHTML"&&console.warn(`[SlickGrid] For better CSP (Content Security Policy) support, do not use "innerHTML" directly in "createDomElement('${t}', { innerHTML: 'some html'})", it is better as separate assignment: "const elm = createDomElement('span'); elm.innerHTML = 'some html';"`);let a=i[l];typeof a=="object"?Object.assign(o[l],a):o[l]=i[l]}),s?.appendChild&&s.appendChild(o),o}static getHtmlStringOutput(t,i="innerHTML"){return t instanceof DocumentFragment?[].map.call(t.childNodes,s=>s[i]).join("")||t.textContent||"":t instanceof HTMLElement?t[i]:String(t)}static emptyElement(t){for(;t?.firstChild;)t.removeChild(t.firstChild);return t}static classNameToList(t=""){return t.split(" ").filter(i=>i)}static innerSize(t,i){let s=0;if(t){let o=i==="height"?"clientHeight":"clientWidth",l=i==="height"?["top","bottom"]:["left","right"];s=t[o];for(let a of l){let h=parseFloat(x.getElementProp(t,`padding-${a}`)||"")||0;s-=h}}return s}static isDefined(t){return t!=null&&t!==""}static getElementProp(t,i){return t?.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue(i):null}static getFunctionDetails(t,i=!0){let s=!1,o=l=>{let a=l.toString();if(s=a.includes("async "),a.replaceAll(" ","").includes("=>({")){let d=a.match(/(({.*}))/g)||[];return d.length>=1?`return ${d[0].trimStart()}`:a}let h=!a.includes("{")&&a.includes("=>"),u=a.substring(a.indexOf("{")+1||a.indexOf("=>")+2,a.includes("}")?a.lastIndexOf("}"):a.length);return i&&h&&!u.startsWith("return")?"return "+u.trimStart():u};return{params:(l=>{let a=/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,)]*))/mg,h=/([^\s,]+)/g,u=l.toString().replace(a,"");return u.slice(u.indexOf("(")+1,u.indexOf(")")).match(h)??[]})(t),body:o(t),isAsync:s}}static insertAfterElement(t,i){t.parentNode?.insertBefore(i,t.nextSibling)}static isEmptyObject(t){return t==null?!0:Object.entries(t).length===0}static noop(){}static offset(t){if(!t||!t.getBoundingClientRect)return;let i=t.getBoundingClientRect(),s=document.documentElement;return{top:i.top+window.pageYOffset-s.clientTop,left:i.left+window.pageXOffset-s.clientLeft}}static windowScrollPosition(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}static width(t,i){if(!(!t||!t.getBoundingClientRect)){if(i===void 0)return t.getBoundingClientRect().width;x.setStyleSize(t,"width",i)}}static height(t,i){if(t){if(i===void 0)return t.getBoundingClientRect().height;x.setStyleSize(t,"height",i)}}static setStyleSize(t,i,s){typeof s=="function"?s=s():typeof s=="string"?t.style[i]=s:t.style[i]=s+"px"}static contains(t,i){return!t||!i?!1:!x.parents(i).every(s=>t!==s)}static isHidden(t){return t.offsetWidth===0&&t.offsetHeight===0}static parents(t,i){let s=[],o=i===":visible",l=i===":hidden";for(;(t=t.parentNode)&&t!==document&&!(!t||!t.parentNode);)l?x.isHidden(t)&&s.push(t):o?x.isHidden(t)||s.push(t):(!i||t.matches(i))&&s.push(t);return s}static toFloat(t){let i=parseFloat(t);return isNaN(i)?0:i}static show(t,i=""){Array.isArray(t)?t.forEach(s=>s.style.display=i):t.style.display=i}static hide(t){Array.isArray(t)?t.forEach(i=>i.style.display="none"):t.style.display="none"}static slideUp(t,i){return x.slideAnimation(t,"slideUp",i)}static slideDown(t,i){return x.slideAnimation(t,"slideDown",i)}static slideAnimation(t,i,s){if(window.jQuery!==void 0){window.jQuery(t)[i]("fast",s);return}i==="slideUp"?x.hide(t):x.show(t),s()}static applyDefaults(t,i){typeof i=="object"&&Object.keys(i).forEach(s=>{i.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(t[s]=i[s])})}static addSlickEventPubSubWhenDefined(t,i){if(t)for(let s in i)i[s]instanceof Y&&typeof i[s].setPubSubService=="function"&&i[s].setPubSubService(t)}};n(M,"getProto",Object.getPrototypeOf),n(M,"class2type",{}),n(M,"toString",M.class2type.toString),n(M,"hasOwn",M.class2type.hasOwnProperty),n(M,"fnToString",M.hasOwn.toString),n(M,"ObjectFunctionString",M.fnToString.call(Object)),n(M,"storage",{_storage:new WeakMap,put:function(e,t,i){this._storage.has(e)||this._storage.set(e,new Map),this._storage.get(e).set(t,i)},get:function(e,t){let i=this._storage.get(e);return i?i.get(t):null},remove:function(e,t){let i=this._storage.get(e).delete(t);return this._storage.get(e).size!==0&&this._storage.delete(e),i}});var $=M,Pe=class{static normaliseDragRange(e){let t={start:{row:(e.end.row??0)>(e.start.row??0)?e.start.row:e.end.row,cell:(e.end.cell??0)>(e.start.cell??0)?e.start.cell:e.end.cell},end:{row:(e.end.row??0)>(e.start.row??0)?e.end.row:e.start.row,cell:(e.end.cell??0)>(e.start.cell??0)?e.end.cell:e.start.cell}};return t.rowCount=(t.end.row??0)-(t.start.row??0)+1,t.cellCount=(t.end.cell??0)-(t.start.cell??0)+1,t.wasDraggedUp=(e.end.row??0)<(e.start.row??0),t.wasDraggedLeft=(e.end.row??0)<(e.start.row??0),t}static copyRangeIsLarger(e,t){return t.fromRow<e.fromRow||t.fromCell<e.fromCell||t.toRow>e.toRow||t.toCell>e.toCell}static normalRangeOppositeCellFromCopy(e,t){let i=t.row<(e.end.row||0)?e.end.row||0:e.start.row||0,s=t.cell<(e.end.cell||0)?e.end.cell||0:e.start.cell||0;return{row:i,cell:s}}static verticalTargetRange(e,t){let i=t.fromRow<e.fromRow,s=t.toRow>e.toRow;if(!i&&!s)return null;let o;return i?o=new D(t.fromRow,t.fromCell,e.fromRow-1,e.toCell):o=new D(e.toRow+1,t.fromCell,t.toRow,e.toCell),o}static horizontalTargetRange(e,t){let i=t.fromCell<e.fromCell,s=t.toCell>e.toCell;if(!i&&!s)return null;let o;return i?o=new D(e.fromRow,t.fromCell,e.toRow,e.fromCell-1):o=new D(e.fromRow,e.toCell+1,e.toRow,t.toCell),o}static cornerTargetRange(e,t){let i=t.fromRow<e.fromRow,s=t.toRow>e.toRow,o=t.fromCell<e.fromCell,l=t.toCell>e.toCell;if(!o&&!l||!i&&!s)return null;let a;return o?i?a=new D(t.fromRow,t.fromCell,e.fromRow-1,e.fromCell-1):a=new D(e.toRow+1,t.fromCell,t.toRow,e.fromCell-1):i?a=new D(t.fromRow,e.toCell+1,e.fromRow-1,t.toCell):a=new D(e.toRow+1,e.toCell+1,t.toRow,t.toCell),a}static copyCellsToTargetRange(e,t,i){let s=0,o=0,l=i.getVisibleColumns(),a=i.getOptions();for(let h=0;h<t.rowCount();h++){let u=i.getDataItem(t.fromRow+h),d=i.getDataItem(e.fromRow+s);o=0;for(let p=0;p<t.cellCount();p++){let c=l[t.fromCell+p],m=l[e.fromCell+o];if(!c.hidden&&!m.hidden){let f=d[m.field];a.dataItemColumnValueExtractor&&(f=a.dataItemColumnValueExtractor(d,m)),u[c.field]=f}o++,o>=e.cellCount()&&(o=0)}s++,s>=e.rowCount()&&(s=0)}}},Me=new ue,Ie={Event:Y,EventData:B,EventHandler:be,Range:ce,CopyRange:ye,DragExtendHandle:Se,NonDataRow:Z,Group:Re,GroupTotals:Ee,EditorLock:ue,RegexSanitizer:ke,GlobalEditorLock:Me,keyCode:{SPACE:8,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentExpandOnly:"CXO",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},CellSelectionMode:{Select:"SEL",Replace:"REP"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{Auto:"AUTO",TextOnly:"CANV",HTML:"HTML"}},{EditorLock:yt,Event:St,EventData:Rt,EventHandler:Et,Group:kt,GroupTotals:xt,NonDataRow:Pt,Range:D,CopyRange:Mt,DragExtendHandle:Le,RegexSanitizer:It,GlobalEditorLock:De,keyCode:pe,preClickClassName:He,GridAutosizeColsMode:Te,ColAutosizeMode:Ae,RowSelectionMode:Oe,CellSelectionMode:ze,ValueFilterMode:Fe,WidthEvalMode:Ve}=Ie;var Ne=$;function Be(e){let{containerElement:t}=e,{onDragInit:i,onDragStart:s,onDrag:o,onDragEnd:l,preventDragFromKeys:a}=e,h,u,d,p,c,m,f;t||(t=document.body);let g={dragSource:t,dragHandle:null};function C(){t&&(t.addEventListener("mousedown",w),t.addEventListener("touchstart",w))}function b(E,k,I){if(typeof E=="function")return E(k,I)}function v(){t&&(t.removeEventListener("mousedown",w),t.removeEventListener("touchstart",w))}function R(E){let k=!1;return a&&a.forEach(I=>{E[I]&&(k=!0)}),k}function w(E){if(!R(E)){h=E.target;let k=E?.touches?.[0]??E,{target:I}=k;if(!e.allowDragFrom||e.allowDragFrom&&h.matches(e.allowDragFrom)||e.allowDragFromClosest&&h.closest(e.allowDragFromClosest)){if(g.dragHandle=h,f="",e.dragFromClassDetectArr){for(let O,K=0;K<e.dragFromClassDetectArr.length;K++)if(O=e.dragFromClassDetectArr[K],O.id&&h.id===O.id||O.cssSelector&&h.matches(O.cssSelector)){f=O.tag;break}}let ie=Ne.windowScrollPosition();u=ie.left+k.clientX,d=ie.top+k.clientY,p=k.clientX-k.clientX,c=k.clientY-k.clientY,g=Object.assign(g,{deltaX:p,deltaY:c,startX:u,startY:d,target:I,matchClassTag:f}),b(i,E,g)!==!1&&(document.body.addEventListener("mousemove",S),document.body.addEventListener("touchmove",S),window.addEventListener("mouseup",y),window.addEventListener("touchend",y),window.addEventListener("touchcancel",y))}}}function S(E){if(!R(E)){let k=E?.touches?.[0]??E;p=k.clientX-u,c=k.clientY-d;let{target:I}=k;m||(g=Object.assign(g,{deltaX:p,deltaY:c,startX:u,startY:d,target:I,matchClassTag:f}),b(s,E,g),m=!0),g=Object.assign(g,{deltaX:p,deltaY:c,startX:u,startY:d,target:I,matchClassTag:f}),b(o,E,g)}}function y(E){if(document.body.removeEventListener("mousemove",S),document.body.removeEventListener("touchmove",S),window.removeEventListener("mouseup",y),window.removeEventListener("touchend",y),window.removeEventListener("touchcancel",y),m){let{target:k}=E;g=Object.assign(g,{target:k}),b(l,E,g),m=!1}}return C(),{destroy:v}}function We(e){let{element:t,onMouseWheel:i}=e;function s(){t.removeEventListener("wheel",l),t.removeEventListener("mousewheel",l)}function o(){t.addEventListener("wheel",l),t.addEventListener("mousewheel",l)}function l(a){let h=a||window.event,u=0,d=0,p=0;h.wheelDelta&&(u=h.wheelDelta/120),h.detail&&(u=-h.detail/3),p=u,h.axis!==void 0&&h.axis===h.HORIZONTAL_AXIS&&(p=0,d=-1*u),h.wheelDeltaY!==void 0&&(p=h.wheelDeltaY/120),h.wheelDeltaX!==void 0&&(d=-1*h.wheelDeltaX/120),typeof i=="function"&&i(a,u,d,p)}return o(),{destroy:s}}function $e(e){let{resizeableElement:t,resizeableHandleElement:i,onResizeStart:s,onResize:o,onResizeEnd:l}=e;if(!i||typeof i.addEventListener!="function")throw new Error("[Slick.Resizable] You did not provide a valid html element that will be used for the handle to resize.");function a(){i.addEventListener("mousedown",d),i.addEventListener("touchstart",d)}function h(){typeof i?.removeEventListener=="function"&&(i.removeEventListener("mousedown",d),i.removeEventListener("touchstart",d))}function u(m,f){if(typeof m=="function")return m(f,{resizeableElement:t,resizeableHandleElement:i})}function d(m){m.preventDefault();let f=m.touches?m.changedTouches[0]:m;u(s,f)!==!1&&(document.body.addEventListener("mousemove",p),document.body.addEventListener("mouseup",c),document.body.addEventListener("touchmove",p),document.body.addEventListener("touchend",c))}function p(m){m.preventDefault&&m.type!=="touchmove"&&m.preventDefault();let f=m.touches?m.changedTouches[0]:m;typeof o=="function"&&o(f,{resizeableElement:t,resizeableHandleElement:i})}function c(m){let f=m.touches?m.changedTouches[0]:m;u(l,f),document.body.removeEventListener("mousemove",p),document.body.removeEventListener("mouseup",c),document.body.removeEventListener("touchmove",p),document.body.removeEventListener("touchend",c)}return a(),{destroy:h}}var W=pe,q=$;var le=class X{constructor(t){this.args=t,n(this,"input"),n(this,"defaultValue"),n(this,"navOnLR"),this.init()}init(){this.navOnLR=this.args.grid.getOptions().editorCellNavOnLRKeys,this.input=q.createDomElement("input",{type:"text",className:"editor-text"},this.args.container),this.input.addEventListener("keydown",this.navOnLR?ne:re),this.input.focus(),this.input.select(),this.args.compositeEditorOptions&&this.input.addEventListener("change",this.onChange.bind(this))}onChange(){let t=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:t?.row??0,cell:t?.cell??0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}destroy(){this.input.removeEventListener("keydown",this.navOnLR?ne:re),this.input.removeEventListener("change",this.onChange.bind(this)),this.input.remove()}focus(){this.input.focus()}getDecimalPlaces(){let t=this.args.column.editorFixedDecimalPlaces;return q.isDefined(t)||(t=X.DefaultDecimalPlaces),!t&&t!==0?null:t}loadValue(t){this.defaultValue=t[this.args.column.field];let i=this.getDecimalPlaces();i!==null&&(this.defaultValue||this.defaultValue===0)&&this.defaultValue?.toFixed&&(this.defaultValue=this.defaultValue.toFixed(i)),this.input.value=String(this.defaultValue??""),this.input.defaultValue=String(this.defaultValue??""),this.input.select()}serializeValue(){let t=parseFloat(this.input.value);X.AllowEmptyValue?!t&&t!==0&&(t=void 0):t=t||0;let i=this.getDecimalPlaces();return i!==null&&(t||t===0)&&t.toFixed&&(t=parseFloat(t.toFixed(i))),t}applyValue(t,i){t[this.args.column.field]=i}isValueChanged(){return!(this.input.value===""&&!q.isDefined(this.defaultValue))&&this.input.value!==this.defaultValue}validate(){if(isNaN(this.input.value))return{valid:!1,msg:"Please enter a valid number"};if(this.args.column.validator){let t=this.args.column.validator(this.input.value,this.args);if(!t.valid)return t}return{valid:!0,msg:null}}};n(le,"DefaultDecimalPlaces"),n(le,"AllowEmptyValue",!1);function ne(e){let t=e.selectionStart,i=e.target.value.length;(e.keyCode===W.LEFT&&t>0||e.keyCode===W.RIGHT&&t<i-1)&&e.stopImmediatePropagation()}function re(e){(e.keyCode===W.LEFT||e.keyCode===W.RIGHT)&&e.stopImmediatePropagation()}var me=$,Ge=(e,t,i)=>!me.isDefined(i)||i===""?"-":i<50?`<span style="color:red;font-weight:bold;">${i}%</span>`:`<span style="color:green">${i}%</span>`,Ue=(e,t,i)=>{if(!me.isDefined(i)||i==="")return"";let s;return i<30?s="red":i<70?s="silver":s="green",`<span class="percent-complete-bar" style="background:${s};width:${i}%" title="${i}%"></span>`},Ke=(e,t,i)=>i?"Yes":"No",qe=(e,t,i)=>`<span class="sgi sgi-checkbox-${i?"intermediate":"blank-outline"}"></span>`,je=(e,t,i)=>i?'<span class="sgi sgi-check"></span>':"",Q={PercentComplete:Ge,PercentCompleteBar:Ue,YesNo:Ke,Checkmark:je,Checkbox:qe},Xe=xe,H=Ae,_=Y,N=B,Ye=De,P=Te,L=pe,Ze=He,Qe=ce,z=Oe,Je=ze,A=Fe,r=$,et=Pe,j=Ve,ae=Be,he=We,de=$e,tt=Le,ge=class{constructor(e,t,i,s,o){if(this.container=e,this.data=t,this.columns=i,this.externalPubSub=o,n(this,"slickGridVersion","5.18.0"),n(this,"cid",""),n(this,"onActiveCellChanged"),n(this,"onActiveCellPositionChanged"),n(this,"onAddNewRow"),n(this,"onAfterSetColumns"),n(this,"onAutosizeColumns"),n(this,"onBeforeAppendCell"),n(this,"onBeforeCellEditorDestroy"),n(this,"onBeforeColumnsResize"),n(this,"onBeforeDestroy"),n(this,"onBeforeEditCell"),n(this,"onBeforeFooterRowCellDestroy"),n(this,"onBeforeHeaderCellDestroy"),n(this,"onBeforeHeaderRowCellDestroy"),n(this,"onBeforeRemoveCachedRow"),n(this,"onBeforeSetColumns"),n(this,"onBeforeSort"),n(this,"onBeforeUpdateColumns"),n(this,"onCellChange"),n(this,"onCellCssStylesChanged"),n(this,"onClick"),n(this,"onColumnsReordered"),n(this,"onColumnsDrag"),n(this,"onColumnsResized"),n(this,"onColumnsResizeDblClick"),n(this,"onCompositeEditorChange"),n(this,"onContextMenu"),n(this,"onDrag"),n(this,"onDblClick"),n(this,"onDragInit"),n(this,"onDragStart"),n(this,"onDragEnd"),n(this,"onFooterClick"),n(this,"onFooterContextMenu"),n(this,"onFooterRowCellRendered"),n(this,"onHeaderCellRendered"),n(this,"onHeaderClick"),n(this,"onHeaderContextMenu"),n(this,"onHeaderMouseEnter"),n(this,"onHeaderMouseLeave"),n(this,"onHeaderRowCellRendered"),n(this,"onHeaderRowMouseEnter"),n(this,"onHeaderRowMouseLeave"),n(this,"onPreHeaderContextMenu"),n(this,"onPreHeaderClick"),n(this,"onKeyDown"),n(this,"onMouseEnter"),n(this,"onMouseLeave"),n(this,"onRendered"),n(this,"onScroll"),n(this,"onSelectedRowsChanged"),n(this,"onSetOptions"),n(this,"onActivateChangedOptions"),n(this,"onSort"),n(this,"onValidationError"),n(this,"onViewportChanged"),n(this,"onDragReplaceCells"),n(this,"scrollbarDimensions"),n(this,"maxSupportedCssHeight"),n(this,"canvas",null),n(this,"canvas_context",null),n(this,"_options"),n(this,"_defaults",{invalidColumnFreezePickerCallback:l=>alert(l),invalidColumnFreezeWidthCallback:l=>alert(l),invalidColumnFreezeWidthMessage:"[SlickGrid] You are trying to freeze/pin more columns than the grid can support. Make sure to have less columns pinned (on the left) than the actual visible grid width.",invalidColumnFreezePickerMessage:'[SlickGrid] Action not allowed and aborted, you need to have at least one or more column on the right section of the column freeze/pining. You could alternatively "Unfreeze all the columns" before trying again.',alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableHtmlRendering:!0,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoEditNewRow:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,unorderableColumnCssClass:"unorderable",asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,auto:!1,nonce:"",editorLock:Ye,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,createTopHeaderPanel:!1,showPreHeaderPanel:!1,showTopHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,preHeaderPanelWidth:"auto",topHeaderPanelHeight:25,topHeaderPanelWidth:"auto",formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",rowHighlightCssClass:"highlight-animate",rowHighlightDuration:400,selectedCellCssClass:"selected",multiSelect:!0,enableCellRowSpan:!1,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,throwWhenFrozenNotAllViewable:!1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:this.defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,preventDragFromKeys:["ctrlKey","metaKey"],showCellSelection:!0,viewportClass:void 0,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,autosizeColsMode:P.LegacyOff,autosizeColPaddingPx:4,rowTopOffsetRenderType:"top",scrollRenderThrottling:10,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,maxPartialRowSpanRemap:5e3,sanitizer:void 0,logSanitizedHtml:!1,mixinDefaults:!0,shadowRoot:void 0}),n(this,"_columnDefaults",{name:"",headerCssClass:null,defaultSortAsc:!0,focusable:!0,hidden:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,reorderable:!0,resizable:!0,sortable:!1,selectable:!0}),n(this,"_columnAutosizeDefaults",{ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:H.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:z.FirstNRows,rowSelectionCount:100,valueFilterMode:A.None,widthEvalMode:j.Auto,sizeToRemaining:void 0,widthPx:void 0,contentSizePx:0,headerWidthPx:0,colDataTypeOf:void 0}),n(this,"_columnResizeTimer"),n(this,"_executionBlockTimer"),n(this,"_flashCellTimer"),n(this,"_highlightRowTimer"),n(this,"th"),n(this,"h"),n(this,"ph"),n(this,"n"),n(this,"cj"),n(this,"page",0),n(this,"offset",0),n(this,"vScrollDir",1),n(this,"_bindingEventService",new Xe),n(this,"initialized",!1),n(this,"_container"),n(this,"uid",`slickgrid_${Math.round(1e6*Math.random())}`),n(this,"dragReplaceEl",new tt(this.uid)),n(this,"_focusSink"),n(this,"_focusSink2"),n(this,"_groupHeaders",[]),n(this,"_headerScroller",[]),n(this,"_headers",[]),n(this,"_headerRows"),n(this,"_headerRowScroller"),n(this,"_headerRowSpacerL"),n(this,"_headerRowSpacerR"),n(this,"_footerRow"),n(this,"_footerRowScroller"),n(this,"_footerRowSpacerL"),n(this,"_footerRowSpacerR"),n(this,"_preHeaderPanel"),n(this,"_preHeaderPanelScroller"),n(this,"_preHeaderPanelSpacer"),n(this,"_preHeaderPanelR"),n(this,"_preHeaderPanelScrollerR"),n(this,"_preHeaderPanelSpacerR"),n(this,"_topHeaderPanel"),n(this,"_topHeaderPanelScroller"),n(this,"_topHeaderPanelSpacer"),n(this,"_topPanelScrollers"),n(this,"_topPanels"),n(this,"_viewport"),n(this,"_canvas"),n(this,"_style"),n(this,"_boundAncestors",[]),n(this,"stylesheet"),n(this,"columnCssRulesL"),n(this,"columnCssRulesR"),n(this,"viewportH",0),n(this,"viewportW",0),n(this,"canvasWidth",0),n(this,"canvasWidthL",0),n(this,"canvasWidthR",0),n(this,"headersWidth",0),n(this,"headersWidthL",0),n(this,"headersWidthR",0),n(this,"viewportHasHScroll",!1),n(this,"viewportHasVScroll",!1),n(this,"headerColumnWidthDiff",0),n(this,"headerColumnHeightDiff",0),n(this,"cellWidthDiff",0),n(this,"cellHeightDiff",0),n(this,"absoluteColumnMinWidth"),n(this,"hasFrozenRows",!1),n(this,"frozenRowsHeight",0),n(this,"actualFrozenRow",-1),n(this,"_prevFrozenColumnIdx",-1),n(this,"_invalidfrozenAlerted",!1),n(this,"paneTopH",0),n(this,"paneBottomH",0),n(this,"viewportTopH",0),n(this,"viewportBottomH",0),n(this,"topPanelH",0),n(this,"headerRowH",0),n(this,"footerRowH",0),n(this,"tabbingDirection",1),n(this,"_activeCanvasNode"),n(this,"_activeViewportNode"),n(this,"activePosX"),n(this,"activePosY"),n(this,"activeRow"),n(this,"activeCell"),n(this,"selectionBottomRow"),n(this,"selectionRightCell"),n(this,"activeCellNode",null),n(this,"currentEditor",null),n(this,"serializedEditorValue"),n(this,"editController"),n(this,"_prevDataLength",0),n(this,"_prevInvalidatedRowsCount",0),n(this,"_rowSpanIsCached",!1),n(this,"_colsWithRowSpanCache",{}),n(this,"rowsCache",{}),n(this,"renderedRows",0),n(this,"numVisibleRows",0),n(this,"prevScrollTop",0),n(this,"scrollHeight",0),n(this,"scrollTop",0),n(this,"lastRenderedScrollTop",0),n(this,"lastRenderedScrollLeft",0),n(this,"prevScrollLeft",0),n(this,"scrollLeft",0),n(this,"selectionModel"),n(this,"selectedRows",[]),n(this,"selectedRanges",[]),n(this,"plugins",[]),n(this,"cellCssClasses",{}),n(this,"columnsById",{}),n(this,"sortColumns",[]),n(this,"columnPosLeft",[]),n(this,"columnPosRight",[]),n(this,"pagingActive",!1),n(this,"pagingIsLastPage",!1),n(this,"scrollThrottle"),n(this,"h_editorLoader"),n(this,"h_postrender"),n(this,"h_postrenderCleanup"),n(this,"postProcessedRows",{}),n(this,"postProcessToRow",null),n(this,"postProcessFromRow",null),n(this,"postProcessedCleanupQueue",[]),n(this,"postProcessgroupId",0),n(this,"counter_rows_rendered",0),n(this,"counter_rows_removed",0),n(this,"_paneHeaderL"),n(this,"_paneHeaderR"),n(this,"_paneTopL"),n(this,"_paneTopR"),n(this,"_paneBottomL"),n(this,"_paneBottomR"),n(this,"_headerScrollerL"),n(this,"_headerScrollerR"),n(this,"_headerL"),n(this,"_headerR"),n(this,"_groupHeadersL"),n(this,"_groupHeadersR"),n(this,"_headerRowScrollerL"),n(this,"_headerRowScrollerR"),n(this,"_footerRowScrollerL"),n(this,"_footerRowScrollerR"),n(this,"_headerRowL"),n(this,"_headerRowR"),n(this,"_footerRowL"),n(this,"_footerRowR"),n(this,"_topPanelScrollerL"),n(this,"_topPanelScrollerR"),n(this,"_topPanelL"),n(this,"_topPanelR"),n(this,"_viewportTopL"),n(this,"_viewportTopR"),n(this,"_viewportBottomL"),n(this,"_viewportBottomR"),n(this,"_canvasTopL"),n(this,"_canvasTopR"),n(this,"_canvasBottomL"),n(this,"_canvasBottomR"),n(this,"_viewportScrollContainerX"),n(this,"_viewportScrollContainerY"),n(this,"_headerScrollContainer"),n(this,"_headerRowScrollContainer"),n(this,"_footerRowScrollContainer"),n(this,"cssShow",{position:"absolute",visibility:"hidden",display:"block"}),n(this,"_hiddenParents",[]),n(this,"oldProps",[]),n(this,"enforceFrozenRowHeightRecalc",!1),n(this,"columnResizeDragging",!1),n(this,"slickDraggableInstance",null),n(this,"slickMouseWheelInstances",[]),n(this,"slickResizableInstances",[]),n(this,"sortableSideLeftInstance"),n(this,"sortableSideRightInstance"),n(this,"logMessageCount",0),n(this,"logMessageMaxCount",30),n(this,"_pubSubService"),this._container=typeof this.container=="string"?document.querySelector(this.container):this.container,!this._container)throw new Error(`SlickGrid requires a valid container, ${this.container} does not exist in the DOM.`);this._pubSubService=o,this.onActiveCellChanged=new _("onActiveCellChanged",o),this.onActiveCellPositionChanged=new _("onActiveCellPositionChanged",o),this.onAddNewRow=new _("onAddNewRow",o),this.onAfterSetColumns=new _("onAfterSetColumns",o),this.onAutosizeColumns=new _("onAutosizeColumns",o),this.onBeforeAppendCell=new _("onBeforeAppendCell",o),this.onBeforeCellEditorDestroy=new _("onBeforeCellEditorDestroy",o),this.onBeforeColumnsResize=new _("onBeforeColumnsResize",o),this.onBeforeDestroy=new _("onBeforeDestroy",o),this.onBeforeEditCell=new _("onBeforeEditCell",o),this.onBeforeFooterRowCellDestroy=new _("onBeforeFooterRowCellDestroy",o),this.onBeforeHeaderCellDestroy=new _("onBeforeHeaderCellDestroy",o),this.onBeforeHeaderRowCellDestroy=new _("onBeforeHeaderRowCellDestroy",o),this.onBeforeRemoveCachedRow=new _("onRowRemovedFromCache",o),this.onBeforeSetColumns=new _("onBeforeSetColumns",o),this.onBeforeSort=new _("onBeforeSort",o),this.onBeforeUpdateColumns=new _("onBeforeUpdateColumns",o),this.onCellChange=new _("onCellChange",o),this.onCellCssStylesChanged=new _("onCellCssStylesChanged",o),this.onClick=new _("onClick",o),this.onColumnsReordered=new _("onColumnsReordered",o),this.onColumnsDrag=new _("onColumnsDrag",o),this.onColumnsResized=new _("onColumnsResized",o),this.onColumnsResizeDblClick=new _("onColumnsResizeDblClick",o),this.onCompositeEditorChange=new _("onCompositeEditorChange",o),this.onContextMenu=new _("onContextMenu",o),this.onDrag=new _("onDrag",o),this.onDblClick=new _("onDblClick",o),this.onDragInit=new _("onDragInit",o),this.onDragStart=new _("onDragStart",o),this.onDragEnd=new _("onDragEnd",o),this.onFooterClick=new _("onFooterClick",o),this.onFooterContextMenu=new _("onFooterContextMenu",o),this.onFooterRowCellRendered=new _("onFooterRowCellRendered",o),this.onHeaderCellRendered=new _("onHeaderCellRendered",o),this.onHeaderClick=new _("onHeaderClick",o),this.onHeaderContextMenu=new _("onHeaderContextMenu",o),this.onHeaderMouseEnter=new _("onHeaderMouseEnter",o),this.onHeaderMouseLeave=new _("onHeaderMouseLeave",o),this.onHeaderRowCellRendered=new _("onHeaderRowCellRendered",o),this.onHeaderRowMouseEnter=new _("onHeaderRowMouseEnter",o),this.onHeaderRowMouseLeave=new _("onHeaderRowMouseLeave",o),this.onPreHeaderClick=new _("onPreHeaderClick",o),this.onPreHeaderContextMenu=new _("onPreHeaderContextMenu",o),this.onKeyDown=new _("onKeyDown",o),this.onMouseEnter=new _("onMouseEnter",o),this.onMouseLeave=new _("onMouseLeave",o),this.onRendered=new _("onRendered",o),this.onScroll=new _("onScroll",o),this.onSelectedRowsChanged=new _("onSelectedRowsChanged",o),this.onSetOptions=new _("onSetOptions",o),this.onActivateChangedOptions=new _("onActivateChangedOptions",o),this.onSort=new _("onSort",o),this.onValidationError=new _("onValidationError",o),this.onViewportChanged=new _("onViewportChanged",o),this.onDragReplaceCells=new _("onDragReplaceCells",o),this.initialize(s)}init(){this.finishInitialization()}initialize(e){if(e?.mixinDefaults?(this._options||(this._options=e),r.applyDefaults(this._options,this._defaults)):this._options=r.extend(!0,{},this._defaults,e),this.scrollThrottle=this.actionThrottle(this.render.bind(this),this._options.scrollRenderThrottling),this.maxSupportedCssHeight=this.maxSupportedCssHeight||this.getMaxSupportedCssHeight(),this.validateAndEnforceOptions(),this._columnDefaults.width=this._options.defaultColumnWidth,this._prevFrozenColumnIdx=this.getFrozenColumnIdx(),this._options.suppressCssChangesOnHiddenInit||this.cacheCssForHiddenInit(),this.updateColumnProps(),this._options.enableColumnReorder&&(!Sortable||!Sortable.create))throw new Error("SlickGrid requires Sortable.js module to be loaded");this.editController={commitCurrentEdit:this.commitCurrentEdit.bind(this),cancelCurrentEdit:this.cancelCurrentEdit.bind(this)},r.emptyElement(this._container),this._container.style.outline=String(0),this._container.classList.add(this.uid),this._container.classList.add("ui-widget"),this._container.setAttribute("role","grid");let t=window.getComputedStyle(this._container);/relative|absolute|fixed/.test(t.position)||(this._container.style.position="relative"),this._focusSink=r.createDomElement("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},this._container),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller=r.createDomElement("div",{className:"slick-topheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._container),this._topHeaderPanelScroller.appendChild(document.createElement("div")),this._topHeaderPanel=r.createDomElement("div",null,this._topHeaderPanelScroller),this._topHeaderPanelSpacer=r.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._topHeaderPanelScroller),this._options.showTopHeaderPanel||r.hide(this._topHeaderPanelScroller)),this._paneHeaderL=r.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},this._container),this._paneHeaderR=r.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},this._container),this._paneTopL=r.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},this._container),this._paneTopR=r.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},this._container),this._paneBottomL=r.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},this._container),this._paneBottomR=r.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},this._container),this._options.createPreHeaderPanel&&(this._preHeaderPanelScroller=r.createDomElement("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderL),this._preHeaderPanelScroller.appendChild(document.createElement("div")),this._preHeaderPanel=r.createDomElement("div",null,this._preHeaderPanelScroller),this._preHeaderPanelSpacer=r.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScroller),this._preHeaderPanelScrollerR=r.createDomElement("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderR),this._preHeaderPanelR=r.createDomElement("div",null,this._preHeaderPanelScrollerR),this._preHeaderPanelSpacerR=r.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScrollerR),this._options.showPreHeaderPanel||(r.hide(this._preHeaderPanelScroller),r.hide(this._preHeaderPanelScrollerR))),this._headerScrollerL=r.createDomElement("div",{className:"slick-header ui-state-default slick-state-default slick-header-left"},this._paneHeaderL),this._headerScrollerR=r.createDomElement("div",{className:"slick-header ui-state-default slick-state-default slick-header-right"},this._paneHeaderR),this._headerScroller.push(this._headerScrollerL),this._headerScroller.push(this._headerScrollerR),this._headerL=r.createDomElement("div",{className:"slick-header-columns slick-header-columns-left",role:"row",style:{left:"-1000px"}},this._headerScrollerL),this._headerR=r.createDomElement("div",{className:"slick-header-columns slick-header-columns-right",role:"row",style:{left:"-1000px"}},this._headerScrollerR),this._headers=[this._headerL,this._headerR],this._headerRowScrollerL=r.createDomElement("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopL),this._headerRowScrollerR=r.createDomElement("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopR),this._headerRowScroller=[this._headerRowScrollerL,this._headerRowScrollerR],this._headerRowSpacerL=r.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerL),this._headerRowSpacerR=r.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerR),this._headerRowL=r.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},this._headerRowScrollerL),this._headerRowR=r.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},this._headerRowScrollerR),this._headerRows=[this._headerRowL,this._headerRowR],this._topPanelScrollerL=r.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopL),this._topPanelScrollerR=r.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopR),this._topPanelScrollers=[this._topPanelScrollerL,this._topPanelScrollerR],this._topPanelL=r.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerL),this._topPanelR=r.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerR),this._topPanels=[this._topPanelL,this._topPanelR],this._options.showColumnHeader||this._headerScroller.forEach(s=>{r.hide(s)}),this._options.showTopPanel||this._topPanelScrollers.forEach(s=>{r.hide(s)}),this._options.showHeaderRow||this._headerRowScroller.forEach(s=>{r.hide(s)}),this._viewportTopL=r.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},this._paneTopL),this._viewportTopR=r.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},this._paneTopR),this._viewportBottomL=r.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},this._paneBottomL),this._viewportBottomR=r.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},this._paneBottomR),this._viewport=[this._viewportTopL,this._viewportTopR,this._viewportBottomL,this._viewportBottomR],this._options.viewportClass&&this._viewport.forEach(s=>{s.classList.add(...r.classNameToList(this._options.viewportClass))}),this._activeViewportNode=this._viewportTopL,this._canvasTopL=r.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},this._viewportTopL),this._canvasTopR=r.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},this._viewportTopR),this._canvasBottomL=r.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},this._viewportBottomL),this._canvasBottomR=r.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},this._viewportBottomR),this._canvas=[this._canvasTopL,this._canvasTopR,this._canvasBottomL,this._canvasBottomR],this.scrollbarDimensions=this.scrollbarDimensions||this.measureScrollbar();let i=this.getCanvasWidth()+this.scrollbarDimensions.width;this._activeCanvasNode=this._canvasTopL,this._topHeaderPanelSpacer&&r.width(this._topHeaderPanelSpacer,i),this._preHeaderPanelSpacer&&r.width(this._preHeaderPanelSpacer,i),this._headers.forEach(s=>{r.width(s,this.getHeadersWidth())}),r.width(this._headerRowSpacerL,i),r.width(this._headerRowSpacerR,i),this._options.createFooterRow&&(this._footerRowScrollerR=r.createDomElement("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopR),this._footerRowScrollerL=r.createDomElement("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopL),this._footerRowScroller=[this._footerRowScrollerL,this._footerRowScrollerR],this._footerRowSpacerL=r.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerL),r.width(this._footerRowSpacerL,i),this._footerRowSpacerR=r.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerR),r.width(this._footerRowSpacerR,i),this._footerRowL=r.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},this._footerRowScrollerL),this._footerRowR=r.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},this._footerRowScrollerR),this._footerRow=[this._footerRowL,this._footerRowR],this._options.showFooterRow||this._footerRowScroller.forEach(s=>{r.hide(s)})),this._focusSink2=this._focusSink.cloneNode(!0),this._container.appendChild(this._focusSink2),this._options.explicitInitialization||this.finishInitialization()}finishInitialization(){this.initialized||(this.initialized=!0,this.getViewportWidth(),this.getViewportHeight(),this.measureCellPaddingAndBorder(),this.disableSelection(this._headers),this._options.enableTextSelectionOnCells||this._viewport.forEach(e=>{this._bindingEventService.bind(e,"selectstart",t=>{t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement||t.preventDefault()})}),this.setFrozenOptions(),this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setScroller(),this.setOverflow(),this.updateColumnCaches(),this.createColumnHeaders(),this.createColumnFooter(),this.setupColumnSort(),this.createCssRules(),this.resizeCanvas(),this.bindAncestorScrollEvents(),this._bindingEventService.bind(this._container,"resize",this.resizeCanvas.bind(this)),this._viewport.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleScroll.bind(this))}),this._options.enableMouseWheelScrollHandler&&this._viewport.forEach(e=>{this.slickMouseWheelInstances.push(he({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))}),this._headerScroller.forEach(e=>{this._bindingEventService.bind(e,"contextmenu",this.handleHeaderContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleHeaderClick.bind(this))}),this._headerRowScroller.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleHeaderRowScroll.bind(this))}),this._options.createFooterRow&&(this._footerRow.forEach(e=>{this._bindingEventService.bind(e,"contextmenu",this.handleFooterContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleFooterClick.bind(this))}),this._footerRowScroller.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleFooterRowScroll.bind(this))})),this._options.createTopHeaderPanel&&this._bindingEventService.bind(this._topHeaderPanelScroller,"scroll",this.handleTopHeaderPanelScroll.bind(this)),this._options.createPreHeaderPanel&&(this._bindingEventService.bind(this._preHeaderPanelScroller,"scroll",this.handlePreHeaderPanelScroll.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScroller,"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScrollerR,"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScroller,"click",this.handlePreHeaderClick.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScrollerR,"click",this.handlePreHeaderClick.bind(this))),this._bindingEventService.bind(this._focusSink,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(this._focusSink2,"keydown",this.handleKeyDown.bind(this)),this._canvas.forEach(e=>{this._bindingEventService.bind(e,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(e,"click",this.handleClick.bind(this)),this._bindingEventService.bind(e,"dblclick",this.handleDblClick.bind(this)),this._bindingEventService.bind(e,"contextmenu",this.handleContextMenu.bind(this)),this._bindingEventService.bind(e,"mouseover",this.handleCellMouseOver.bind(this)),this._bindingEventService.bind(e,"mouseout",this.handleCellMouseOut.bind(this))}),ae&&(this.slickDraggableInstance=ae({containerElement:this._container,allowDragFrom:`div.slick-cell, div.slick-cell *, div.${this.dragReplaceEl.cssClass}`,dragFromClassDetectArr:[{tag:"dragReplaceHandle",id:this.dragReplaceEl.id}],allowDragFromClosest:"div.slick-cell.dnd, div.slick-cell.cell-reorder",preventDragFromKeys:this._options.preventDragFromKeys,onDragInit:this.handleDragInit.bind(this),onDragStart:this.handleDragStart.bind(this),onDrag:this.handleDrag.bind(this),onDragEnd:this.handleDragEnd.bind(this)})),this._options.suppressCssChangesOnHiddenInit||this.restoreCssFromHiddenInit())}cacheCssForHiddenInit(){this._hiddenParents=r.parents(this._container,":hidden"),this.oldProps=[],this._hiddenParents.forEach(e=>{let t={};Object.keys(this.cssShow).forEach(i=>{this.cssShow&&(t[i]=e.style[i],e.style[i]=this.cssShow[i])}),this.oldProps.push(t)})}restoreCssFromHiddenInit(){let e=0;this._hiddenParents&&(this._hiddenParents.forEach(t=>{let i=this.oldProps[e++];Object.keys(this.cssShow).forEach(s=>{this.cssShow&&(t.style[s]=i[s])})}),this._hiddenParents=[])}registerPlugin(e){this.plugins.unshift(e),e.init(this)}unregisterPlugin(e){for(let t=this.plugins.length;t>=0;t--)if(this.plugins[t]===e){this.plugins[t]?.destroy(),this.plugins.splice(t,1);break}}destroy(e){this._bindingEventService.unbindAll(),this.slickDraggableInstance=this.destroyAllInstances(this.slickDraggableInstance),this.slickMouseWheelInstances=this.destroyAllInstances(this.slickMouseWheelInstances),this.slickResizableInstances=this.destroyAllInstances(this.slickResizableInstances),this.getEditorLock()?.cancelCurrentEdit(),this.trigger(this.onBeforeDestroy,{});let t=this.plugins.length;for(;t--;)this.unregisterPlugin(this.plugins[t]);this._options.enableColumnReorder&&typeof this.sortableSideLeftInstance?.destroy=="function"&&(this.sortableSideLeftInstance?.destroy(),this.sortableSideRightInstance?.destroy()),this.unbindAncestorScrollEvents(),this._bindingEventService.unbindByEventName(this._container,"resize"),this.removeCssRules(),this._canvas.forEach(o=>{this._bindingEventService.unbindByEventName(o,"keydown"),this._bindingEventService.unbindByEventName(o,"click"),this._bindingEventService.unbindByEventName(o,"dblclick"),this._bindingEventService.unbindByEventName(o,"contextmenu"),this._bindingEventService.unbindByEventName(o,"mouseover"),this._bindingEventService.unbindByEventName(o,"mouseout")}),this._viewport.forEach(o=>{this._bindingEventService.unbindByEventName(o,"scroll")}),this._headerScroller.forEach(o=>{this._bindingEventService.unbindByEventName(o,"contextmenu"),this._bindingEventService.unbindByEventName(o,"click")}),this._headerRowScroller.forEach(o=>{this._bindingEventService.unbindByEventName(o,"scroll")}),this._footerRow&&this._footerRow.forEach(o=>{this._bindingEventService.unbindByEventName(o,"contextmenu"),this._bindingEventService.unbindByEventName(o,"click")}),this._footerRowScroller&&this._footerRowScroller.forEach(o=>{this._bindingEventService.unbindByEventName(o,"scroll")}),this._preHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._preHeaderPanelScroller,"scroll"),this._topHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._topHeaderPanelScroller,"scroll"),this._bindingEventService.unbindByEventName(this._focusSink,"keydown"),this._bindingEventService.unbindByEventName(this._focusSink2,"keydown");let i=this._container.querySelectorAll(".slick-resizable-handle");[].forEach.call(i,o=>{this._bindingEventService.unbindByEventName(o,"dblclick")});let s=this._container.querySelectorAll(".slick-header-column");[].forEach.call(s,o=>{this._bindingEventService.unbindByEventName(o,"mouseenter"),this._bindingEventService.unbindByEventName(o,"mouseleave"),this._bindingEventService.unbindByEventName(o,"mouseenter"),this._bindingEventService.unbindByEventName(o,"mouseleave")}),r.emptyElement(this._container),this._container.classList.remove(this.uid),this.clearAllTimers(),e&&this.destroyAllElements()}destroyAllInstances(e){if(e){let t=Array.isArray(e)?e:[e],i;for(;r.isDefined(i=t.pop());)i&&typeof i.destroy=="function"&&i.destroy()}return e=Array.isArray(e)?[]:null,e}destroyAllElements(){this._activeCanvasNode=null,this._activeViewportNode=null,this._boundAncestors=null,this._canvas=null,this._canvasTopL=null,this._canvasTopR=null,this._canvasBottomL=null,this._canvasBottomR=null,this._container=null,this._focusSink=null,this._focusSink2=null,this._groupHeaders=null,this._groupHeadersL=null,this._groupHeadersR=null,this._headerL=null,this._headerR=null,this._headers=null,this._headerRows=null,this._headerRowL=null,this._headerRowR=null,this._headerRowSpacerL=null,this._headerRowSpacerR=null,this._headerRowScrollContainer=null,this._headerRowScroller=null,this._headerRowScrollerL=null,this._headerRowScrollerR=null,this._headerScrollContainer=null,this._headerScroller=null,this._headerScrollerL=null,this._headerScrollerR=null,this._hiddenParents=null,this._footerRow=null,this._footerRowL=null,this._footerRowR=null,this._footerRowSpacerL=null,this._footerRowSpacerR=null,this._footerRowScroller=null,this._footerRowScrollerL=null,this._footerRowScrollerR=null,this._footerRowScrollContainer=null,this._preHeaderPanel=null,this._preHeaderPanelR=null,this._preHeaderPanelScroller=null,this._preHeaderPanelScrollerR=null,this._preHeaderPanelSpacer=null,this._preHeaderPanelSpacerR=null,this._topPanels=null,this._topPanelScrollers=null,this._style=null,this._topPanelScrollerL=null,this._topPanelScrollerR=null,this._topPanelL=null,this._topPanelR=null,this._paneHeaderL=null,this._paneHeaderR=null,this._paneTopL=null,this._paneTopR=null,this._paneBottomL=null,this._paneBottomR=null,this._viewport=null,this._viewportTopL=null,this._viewportTopR=null,this._viewportBottomL=null,this._viewportBottomR=null,this._viewportScrollContainerX=null,this._viewportScrollContainerY=null}getOptions(){return this._options}getFrozenColumnId(){let e=this.getFrozenColumnIdx();return e>=0&&this.columns[e]?this.columns[e].id:null}getFrozenColumnIdx(){return this._options.frozenColumn??-1}setOptions(e,t,i,s){this.prepareForOptionsChange(),this._options.enableAddRow!==e.enableAddRow&&this.invalidateRow(this.getDataLength()),e.frozenColumn!==void 0&&e.frozenColumn>=0&&(this._prevFrozenColumnIdx=this.getFrozenColumnIdx(),i||(this._invalidfrozenAlerted=!1),this.validateColumnFreezeWidth(e.frozenColumn)?(this.getViewports().forEach(l=>l.scrollLeft=0),this.handleScroll()):e.frozenColumn=this._prevFrozenColumnIdx<e.frozenColumn?this._prevFrozenColumnIdx:-1);let o=r.extend(!0,{},this._options);this._options=r.extend(this._options,e),this.trigger(this.onSetOptions,{optionsBefore:o,optionsAfter:this._options}),this.internal_setOptions(t,i,s)}activateChangedOptions(e,t,i){this.prepareForOptionsChange(),this.invalidateRow(this.getDataLength()),this.trigger(this.onActivateChangedOptions,{options:this._options}),this.internal_setOptions(e,t,i)}prepareForOptionsChange(){this.getEditorLock().commitCurrentEdit()&&this.makeActiveCellNormal()}internal_setOptions(e,t,i){this._options.showColumnHeader!==void 0&&this.setColumnHeaderVisibility(this._options.showColumnHeader),this.validateAndEnforceOptions(),this.setFrozenOptions(),this._options.frozenBottom!==void 0&&(this.enforceFrozenRowHeightRecalc=!0),this._viewport.forEach(s=>{s.style.overflowY=this._options.autoHeight?"hidden":"auto"}),e||this.render(),this.setScroller(),i||this.setOverflow(),t||this.setColumns(this.columns),this._options.enableMouseWheelScrollHandler&&this._viewport&&(!this.slickMouseWheelInstances||this.slickMouseWheelInstances.length===0)?this._viewport.forEach(s=>{this.slickMouseWheelInstances.push(he({element:s,onMouseWheel:this.handleMouseWheel.bind(this)}))}):this._options.enableMouseWheelScrollHandler===!1&&this.destroyAllInstances(this.slickMouseWheelInstances)}validateAndEnforceOptions(){this._options.autoHeight&&(this._options.leaveSpaceForNewRows=!1),this._options.forceFitColumns&&(this._options.autosizeColsMode=P.LegacyForceFit),this.validateColumnFreezeWidth(this._options.frozenColumn)||(this._options.frozenColumn=this._prevFrozenColumnIdx<this._options.frozenColumn?this._prevFrozenColumnIdx:-1)}setSelectionModel(e){this.selectionModel&&(this.selectionModel.onSelectedRangesChanged.unsubscribe(this.handleSelectedRangesChanged.bind(this)),this.selectionModel.destroy&&this.selectionModel.destroy()),this.selectionModel=e,this.selectionModel&&(this.selectionModel.init(this),this.selectionModel.onSelectedRangesChanged.subscribe(this.handleSelectedRangesChanged.bind(this)))}getSelectionModel(){return this.selectionModel}setPaneFrozenClasses(){let e=this.hasFrozenColumns()?"add":"remove";for(let t of[this._paneHeaderL,this._paneTopL,this._paneBottomL])t.classList[e]("frozen")}hasFrozenColumns(){return this._options.frozenColumn>-1}updateColumnHeader(e,t,i){if(this.initialized){let s=this.getColumnIndex(e);if(!r.isDefined(s))return;let o=this.columns[s],l=this.getColumnByIndex(s);l&&(t!==void 0&&(this.columns[s].name=t),i!==void 0&&(this.columns[s].toolTip=i),this.trigger(this.onBeforeHeaderCellDestroy,{node:l,column:o,grid:this}),l.setAttribute("title",i||""),t!==void 0&&this.applyHtmlCode(l.children[0],t),this.trigger(this.onHeaderCellRendered,{node:l,column:o,grid:this}))}}getHeader(e){if(!e)return this.hasFrozenColumns()?this._headers:this._headerL;let t=this.getColumnIndex(e.id);return this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL}getHeaderColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),i=this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,s=this.hasFrozenColumns()?t<=this._options.frozenColumn?t:t-this._options.frozenColumn-1:t;return i.children[s]}getHeaderRow(){return this.hasFrozenColumns()?this._headerRows:this._headerRows[0]}getFooterRow(){return this.hasFrozenColumns()?this._footerRow:this._footerRow[0]}getHeaderRowColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),i;return this.hasFrozenColumns()?t<=this._options.frozenColumn?i=this._headerRowL:(i=this._headerRowR,t-=this._options.frozenColumn+1):i=this._headerRowL,i.children[t]}getFooterRowColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),i;return this.hasFrozenColumns()?t<=this._options.frozenColumn?i=this._footerRowL:(i=this._footerRowR,t-=this._options.frozenColumn+1):i=this._footerRowL,i.children[t]}createColumnFooter(){if(this._options.createFooterRow){this._footerRow.forEach(e=>{e.querySelectorAll(".slick-footerrow-column").forEach(t=>{let i=r.storage.get(t,"column");this.trigger(this.onBeforeFooterRowCellDestroy,{node:t,column:i,grid:this})})}),r.emptyElement(this._footerRowL),r.emptyElement(this._footerRowR);for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(!t||t.hidden)continue;let i=r.createDomElement("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()&&e>this._options.frozenColumn?this._footerRowR:this._footerRowL),s=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;s&&i.classList.add(s),r.storage.put(i,"column",t),this.trigger(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}}setupColumnSort(){this._headers.forEach(e=>{this._bindingEventService.bind(e,"click",t=>{if(this.columnResizeDragging||t.target.classList.contains("slick-resizable-handle"))return;let i=t.target.closest(".slick-header-column");if(!i)return;let s=r.storage.get(i,"column");if(s.sortable){if(!this.getEditorLock()?.commitCurrentEdit())return;let o=this.sortColumns.slice(),l=null,a=0;for(;a<this.sortColumns.length;a++)if(this.sortColumns[a].columnId===s.id){l=this.sortColumns[a],l.sortAsc=!l.sortAsc;break}let h=!!l;this._options.tristateMultiColumnSort?(l||(l={columnId:s.id,sortAsc:s.defaultSortAsc,sortCol:s}),h&&l.sortAsc&&(this.sortColumns.splice(a,1),l=null),this._options.multiColumnSort||(this.sortColumns=[]),l&&(!h||!this._options.multiColumnSort)&&this.sortColumns.push(l)):t.metaKey&&this._options.multiColumnSort?l&&this.sortColumns.splice(a,1):((!t.shiftKey&&!t.metaKey||!this._options.multiColumnSort)&&(this.sortColumns=[]),l?this.sortColumns.length===0&&this.sortColumns.push(l):(l={columnId:s.id,sortAsc:s.defaultSortAsc,sortCol:s},this.sortColumns.push(l)));let u;this._options.multiColumnSort?u={multiColumnSort:!0,previousSortColumns:o,sortCols:this.sortColumns.map(d=>{let p=this.columns[this.getColumnIndex(d.columnId)];return!p||p.hidden?null:{columnId:p.id,sortCol:p,sortAsc:d.sortAsc}}).filter(d=>d)}:u={multiColumnSort:!1,previousSortColumns:o,columnId:this.sortColumns.length>0?s.id:null,sortCol:this.sortColumns.length>0?s:null,sortAsc:this.sortColumns.length>0?this.sortColumns[0].sortAsc:!0},this.trigger(this.onBeforeSort,u,t).getReturnValue()!==!1&&(this.setSortColumns(this.sortColumns),this.trigger(this.onSort,u,t))}})})}createColumnHeaders(){this._headers.forEach(e=>{e.querySelectorAll(".slick-header-column").forEach(t=>{let i=r.storage.get(t,"column");i&&this.trigger(this.onBeforeHeaderCellDestroy,{node:t,column:i,grid:this})})}),r.emptyElement(this._headerL),r.emptyElement(this._headerR),this.getHeadersWidth(),r.width(this._headerL,this.headersWidthL),r.width(this._headerR,this.headersWidthR),this._headerRows.forEach(e=>{e.querySelectorAll(".slick-headerrow-column").forEach(t=>{let i=r.storage.get(t,"column");i&&this.trigger(this.onBeforeHeaderRowCellDestroy,{node:this,column:i,grid:this})})}),r.emptyElement(this._headerRowL),r.emptyElement(this._headerRowR),this._options.createFooterRow&&(this._footerRowL.querySelectorAll(".slick-footerrow-column").forEach(e=>{let t=r.storage.get(e,"column");t&&this.trigger(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})}),r.emptyElement(this._footerRowL),this.hasFrozenColumns()&&(this._footerRowR.querySelectorAll(".slick-footerrow-column").forEach(e=>{let t=r.storage.get(e,"column");t&&this.trigger(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})}),r.emptyElement(this._footerRowR)));for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(t.hidden)continue;let i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,s=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerRowL:this._headerRowR:this._headerRowL,o=r.createDomElement("div",{id:`${this.uid+t.id}`,dataset:{id:String(t.id)},role:"columnheader",className:"ui-state-default slick-state-default slick-header-column"},i);t.toolTip&&(o.title=t.toolTip),t.reorderable||o.classList.add(this._options.unorderableColumnCssClass);let l=r.createDomElement("span",{className:"slick-column-name"},o);this.applyHtmlCode(l,t.name),r.width(o,t.width-this.headerColumnWidthDiff);let a=t.headerCssClass||null;if(a&&o.classList.add(...r.classNameToList(a)),a=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null,a&&o.classList.add(a),this._bindingEventService.bind(o,"mouseenter",this.handleHeaderMouseEnter.bind(this)),this._bindingEventService.bind(o,"mouseleave",this.handleHeaderMouseLeave.bind(this)),r.storage.put(o,"column",t),(this._options.enableColumnReorder||t.sortable)&&(this._bindingEventService.bind(o,"mouseenter",this.handleHeaderMouseHoverOn.bind(this)),this._bindingEventService.bind(o,"mouseleave",this.handleHeaderMouseHoverOff.bind(this))),t.hasOwnProperty("headerCellAttrs")&&t.headerCellAttrs instanceof Object&&Object.keys(t.headerCellAttrs).forEach(h=>{t.headerCellAttrs.hasOwnProperty(h)&&o.setAttribute(h,t.headerCellAttrs[h])}),t.sortable&&(o.classList.add("slick-header-sortable"),r.createDomElement("div",{className:`slick-sort-indicator ${this._options.numberedMultiColumnSort&&!this._options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":""}`},o),this._options.numberedMultiColumnSort&&this._options.sortColNumberInSeparateSpan&&r.createDomElement("div",{className:"slick-sort-indicator-numbered"},o)),this.trigger(this.onHeaderCellRendered,{node:o,column:t,grid:this}),this._options.showHeaderRow){let h=r.createDomElement("div",{className:`ui-state-default slick-state-default slick-headerrow-column l${e} r${e}`},s),u=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;u&&h.classList.add(u),this._bindingEventService.bind(h,"mouseenter",this.handleHeaderRowMouseEnter.bind(this)),this._bindingEventService.bind(h,"mouseleave",this.handleHeaderRowMouseLeave.bind(this)),r.storage.put(h,"column",t),this.trigger(this.onHeaderRowCellRendered,{node:h,column:t,grid:this})}if(this._options.createFooterRow&&this._options.showFooterRow){let h=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._footerRow[0]:this._footerRow[1]:this._footerRow[0],u=r.createDomElement("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},h);r.storage.put(u,"column",t),this.trigger(this.onFooterRowCellRendered,{node:u,column:t,grid:this})}}this.setSortColumns(this.sortColumns),this.setupColumnResize(),this._options.enableColumnReorder&&(typeof this._options.enableColumnReorder=="function"?this._options.enableColumnReorder(this,this._headers,this.headerColumnWidthDiff,this.setColumns,this.setupColumnResize,this.columns,this.getColumnIndex,this.uid,this.trigger):this.setupColumnReorder())}setupColumnReorder(){this.sortableSideLeftInstance?.destroy(),this.sortableSideRightInstance?.destroy();let e=null,t=()=>this._viewportScrollContainerX.scrollLeft=this._viewportScrollContainerX.scrollLeft+10,i=()=>this._viewportScrollContainerX.scrollLeft=this._viewportScrollContainerX.scrollLeft-10,s=[],o=!1,l={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,preventOnFilter:!1,revertClone:!0,scroll:!this.hasFrozenColumns(),filter:`.${this._options.unorderableColumnCssClass}`,onMove:a=>!a.related.classList.contains(this._options.unorderableColumnCssClass),onStart:a=>{a.item.classList.add("slick-header-column-active"),o=!this.hasFrozenColumns()||r.offset(a.item).left>r.offset(this._viewportScrollContainerX).left,o&&a.originalEvent.pageX>this._container.clientWidth?e||(e=window.setInterval(t,100)):o&&a.originalEvent.pageX<r.offset(this._viewportScrollContainerX).left?e||(e=window.setInterval(i,100)):(window.clearInterval(e),e=null),s=this.columns.map(h=>h.id)},onEnd:a=>{a.item.classList.remove("slick-header-column-active"),clearInterval(e);let h=this.scrollLeft;if(!this.getEditorLock()?.commitCurrentEdit())return;let u=this.sortableSideLeftInstance?.toArray()??[];u=u.concat(this.sortableSideRightInstance?.toArray()??[]);let d=[];for(let p=0;p<u.length;p++)d.push(this.columns[this.getColumnIndex(u[p])]);a.stopPropagation(),this.arrayEquals(s,u)||(this.setColumns(d),this.scrollToX(h),this.trigger(this.onColumnsReordered,{impactedColumns:this.columns,previousColumnOrder:s}),this.setupColumnResize()),this.activeCellNode&&this.setFocus()}};this.sortableSideLeftInstance=Sortable.create(this._headerL,l),this.sortableSideRightInstance=Sortable.create(this._headerR,l)}getHeaderChildren(){let e=Array.from(this._headers[0].children),t=Array.from(this._headers[1].children);return e.concat(t)}handleResizeableDoubleClick(e){let t=e.target.parentElement.id.replace(this.uid,"");this.trigger(this.onColumnsResizeDblClick,{triggeredByColumn:t})}setupColumnResize(){if(typeof de>"u")throw new Error('Slick.Resizable is undefined, make sure to import "slick.interactions.js"');let e,t,i,s,o,l,a,h=-1,u=0,d=this.getHeaderChildren(),p=this.getVisibleColumns();for(let c=0;c<d.length;c++)d[c].querySelectorAll(".slick-resizable-handle").forEach(m=>m.remove()),!(c>=p.length||!p[c])&&p[c].resizable&&(a===void 0&&(a=c),h=c);if(a!==void 0)for(let c=0;c<d.length;c++){let m=d[c];if(c>=p.length||!p[c]||c<a||this._options.forceFitColumns&&c>=h)continue;let f=r.createDomElement("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},m);this._bindingEventService.bind(f,"dblclick",this.handleResizeableDoubleClick.bind(this)),this.slickResizableInstances.push(de({resizeableElement:m,resizeableHandleElement:f,onResizeStart:(g,C)=>{let b=g.touches?g.changedTouches[0]:g;if(!this.getEditorLock()?.commitCurrentEdit())return!1;s=b.pageX,u=0,C.resizeableElement.classList.add("slick-header-column-active");let v=null,R=null;for(let y=0;y<d.length;y++)y>=p.length||!p[y]||(p[y].previousWidth=d[y].offsetWidth);if(this._options.forceFitColumns)for(v=0,R=0,e=c+1;e<p.length;e++)i=p[e],i?.resizable&&(R!==null&&(i.maxWidth?R+=i.maxWidth-(i.previousWidth||0):R=null),v+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));let w=0,S=0;for(e=0;e<=c;e++)i=p[e],i?.resizable&&(S!==null&&(i.maxWidth?S+=i.maxWidth-(i.previousWidth||0):S=null),w+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));v===null&&(v=1e5),w===null&&(w=1e5),R===null&&(R=1e5),S===null&&(S=1e5),l=s+Math.min(v,S),o=s-Math.min(w,R)},onResize:(g,C)=>{let b=g.touches?g.changedTouches[0]:g;this.columnResizeDragging=!0;let v,R=Math.min(l,Math.max(o,b.pageX))-s,w,S=0,y=0,E=this.getViewportInnerWidth();if(R<0){for(w=R,e=c;e>=0;e--)i=p[e],i?.resizable&&!i.hidden&&(v=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),w&&(i.previousWidth||0)+w<v?(w+=(i.previousWidth||0)-v,i.width=v):(i.width=(i.previousWidth||0)+w,w=0));for(t=0;t<=c;t++)i=p[t],!(!i||i.hidden)&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?y+=i.width||0:S+=i.width||0);if(this._options.forceFitColumns)for(w=-R,e=c+1;e<p.length;e++)i=p[e],!(!i||i.hidden)&&i.resizable&&(w&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<w?(w-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+w,w=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?y+=i.width||0:S+=i.width||0);else for(e=c+1;e<p.length;e++)i=p[e],!(!i||i.hidden)&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?y+=i.width||0:S+=i.width||0);if(this._options.forceFitColumns)for(w=-R,e=c+1;e<p.length;e++)i=p[e],!(!i||i.hidden)&&i.resizable&&(w&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<w?(w-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+w,w=0))}else{for(w=R,S=0,y=0,e=c;e>=0;e--)if(i=p[e],!(!i||i.hidden)&&i.resizable)if(w&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<w)w-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth;else{let k=(i.previousWidth||0)+w,I=this.canvasWidthL+w;this.hasFrozenColumns()&&e<=this._options.frozenColumn?(k>u&&I<E-this._options.frozenRightViewportMinWidth&&(u=k),i.width=I+this._options.frozenRightViewportMinWidth>E?u:k):i.width=k,w=0}for(t=0;t<=c;t++)i=p[t],!(!i||i.hidden)&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?y+=i.width||0:S+=i.width||0);if(this._options.forceFitColumns)for(w=-R,e=c+1;e<p.length;e++)i=p[e],!(!i||i.hidden)&&i.resizable&&(v=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),w&&(i.previousWidth||0)+w<v?(w+=(i.previousWidth||0)-v,i.width=v):(i.width=(i.previousWidth||0)+w,w=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?y+=i.width||0:S+=i.width||0);else for(e=c+1;e<p.length;e++)i=p[e],!(!i||i.hidden)&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?y+=i.width||0:S+=i.width||0)}this.hasFrozenColumns()&&S!==this.canvasWidthL&&(r.width(this._headerL,S+1e3),r.setStyleSize(this._paneHeaderR,"left",S)),this.applyColumnHeaderWidths(),this._options.syncColumnCellResize&&this.applyColumnWidths(),this.trigger(this.onColumnsDrag,{triggeredByColumn:C.resizeableElement,resizeHandle:C.resizeableHandleElement})},onResizeEnd:(g,C)=>{C.resizeableElement.classList.remove("slick-header-column-active");let b=C.resizeableElement.id.replace(this.uid,"");this.trigger(this.onBeforeColumnsResize,{triggeredByColumn:b}).getReturnValue()===!0&&this.applyColumnHeaderWidths();let v;for(e=0;e<p.length;e++)i=p[e],!(!i||i.hidden)&&(v=d[e].offsetWidth,i.previousWidth!==v&&i.rerenderOnResize&&this.invalidateAllRows());this.updateCanvasWidth(!0),this.render(),this.trigger(this.onColumnsResized,{triggeredByColumn:b}),window.clearTimeout(this._columnResizeTimer),this._columnResizeTimer=window.setTimeout(()=>{this.columnResizeDragging=!1},300)}}))}}setFrozenOptions(){if(this._options.frozenColumn=this._options.frozenColumn>=0&&this._options.frozenColumn<this.columns.length?parseInt(this._options.frozenColumn,10):-1,this._options.frozenRow>-1){this.hasFrozenRows=!0,this.frozenRowsHeight=this._options.frozenRow*this._options.rowHeight;let e=this.getDataLength();this.actualFrozenRow=this._options.frozenBottom?e-this._options.frozenRow:this._options.frozenRow}else this.hasFrozenRows=!1}autosizeColumn(e,t){let i=null,s=-1;if(typeof e=="number")i=this.columns[e],s=e;else if(typeof e=="string")for(let l=0;l<this.columns.length;l++)this.columns[l].id===e&&(i=this.columns[l],s=l);if(!i)return;let o=this.getCanvasNode(0,0);this.getColAutosizeWidth(i,s,o,t||!1,s)}treatAsLocked(e={}){return!e.ignoreHeaderText&&!e.sizeToRemaining&&e.contentSizePx===e.headerWidthPx&&(e.widthPx??0)<100}autosizeColumns(e,t){let i=!this._hiddenParents?.length;i&&this.cacheCssForHiddenInit(),this.internalAutosizeColumns(e,t),i&&this.restoreCssFromHiddenInit()}internalAutosizeColumns(e,t){if(e=e||this._options.autosizeColsMode,e===P.LegacyForceFit||e===P.LegacyOff){this.legacyAutosizeColumns();return}if(e===P.None)return;this.canvas=document.createElement("canvas"),this.canvas?.getContext&&(this.canvas_context=this.canvas.getContext("2d"));let i=this.getCanvasNode(0,0),s=this.getViewportInnerWidth(),o,l,a,h=!1,u=0,d=0,p=0,c=0,m=0;for(o=0;o<this.columns.length;o++)l=this.columns[o],this.getColAutosizeWidth(l,o,i,t||!1,o),m+=l.autoSize?.autosizeMode===H.Locked?l.width||0:this.treatAsLocked(l.autoSize)&&l.autoSize?.widthPx||0,c+=l.autoSize?.autosizeMode===H.Locked?l.width||0:this.treatAsLocked(l.autoSize)?l.autoSize?.widthPx||0:l.minWidth||0,u+=l.autoSize?.widthPx||0,d+=l.autoSize?.sizeToRemaining?0:l.autoSize?.widthPx||0,p+=l.autoSize?.sizeToRemaining&&l.minWidth||0;let f=u-d;if(e===P.FitViewportToCols){let g=u+(this.scrollbarDimensions?.width??0);e=P.IgnoreViewport,this._options.viewportMaxWidthPx&&g>this._options.viewportMaxWidthPx?(g=this._options.viewportMaxWidthPx,e=P.FitColsToViewport):this._options.viewportMinWidthPx&&g<this._options.viewportMinWidthPx&&(g=this._options.viewportMinWidthPx,e=P.FitColsToViewport),r.width(this._container,g)}if(e===P.FitColsToViewport)if(f>0&&d<s-p)for(o=0;o<this.columns.length;o++){if(l=this.columns[o],!l||l.hidden)continue;let g=s-d;l.autoSize?.sizeToRemaining?a=g*(l.autoSize?.widthPx||0)/f:a=l.autoSize?.widthPx||0,l.rerenderOnResize&&(l.width||0)!==a&&(h=!0),l.width=a}else if(this._options.viewportSwitchToScrollModeWidthPercent&&d+p>s*this._options.viewportSwitchToScrollModeWidthPercent/100||c>s)e=P.IgnoreViewport;else{let g=d-m,C=s-m-p;for(o=0;o<this.columns.length;o++)l=this.columns[o],!(!l||l.hidden)&&(a=l.width||0,l.autoSize?.autosizeMode!==H.Locked&&!this.treatAsLocked(l.autoSize)&&(l.autoSize?.sizeToRemaining?a=l.minWidth||0:(a=C/g*(l.autoSize?.widthPx||0)-1,a<(l.minWidth||0)&&(a=l.minWidth||0),g-=l.autoSize?.widthPx||0,C-=a)),this.treatAsLocked(l.autoSize)&&(a=l.autoSize?.widthPx||0,a<(l.minWidth||0)&&(a=l.minWidth||0)),l.rerenderOnResize&&l.width!==a&&(h=!0),l.width=a)}if(e===P.IgnoreViewport)for(o=0;o<this.columns.length;o++)!this.columns[o]||this.columns[o].hidden||(a=this.columns[o].autoSize?.widthPx||0,this.columns[o].rerenderOnResize&&this.columns[o].width!==a&&(h=!0),this.columns[o].width=a);this.reRenderColumns(h)}getColAutosizeWidth(e,t,i,s,o){let l=e.autoSize;if(l.widthPx=e.width,l.autosizeMode===H.Locked||l.autosizeMode===H.Guide)return;let a=this.getDataLength(),h=new RegExp(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z/);if(l.autosizeMode===H.ContentIntelligent){let p=l.colDataTypeOf,c;if(a>0){let m=this.getDataItem(0);m&&(c=m[e.field],h.test(c)&&(c=Date.parse(c)),p=typeof c,p==="object"&&(c instanceof Date&&(p="date"),typeof moment<"u"&&c instanceof moment&&(p="moment")))}p==="boolean"&&(l.colValueArray=[!0,!1]),p==="number"&&(l.valueFilterMode=A.GetGreatestAndSub,l.rowSelectionMode=z.AllRows),p==="string"&&(l.valueFilterMode=A.GetLongestText,l.rowSelectionMode=z.AllRows,l.allowAddlPercent=5),p==="date"&&(l.colValueArray=[new Date(2009,8,30,12,20,20)]),p==="moment"&&typeof moment<"u"&&(l.colValueArray=[moment([2009,8,30,12,20,20])])}let u=l.contentSizePx=this.getColContentSize(e,t,i,s,o);u===0&&(u=l.widthPx||0);let d=l.allowAddlPercent?1+l.allowAddlPercent/100:1;u=u*d+(this._options.autosizeColPaddingPx||0),e.minWidth&&u<e.minWidth&&(u=e.minWidth),e.maxWidth&&u>e.maxWidth&&(u=e.maxWidth),(l.autosizeMode===H.ContentExpandOnly||e?.editor?.ControlFillsColumn)&&u<(e.width||0)&&(u=e.width||0),l.widthPx=u}getColContentSize(e,t,i,s,o){let l=e.autoSize,a=1,h,u,d=0,p=0;if(l.headerWidthPx=0,l.ignoreHeaderText||(l.headerWidthPx=this.getColHeaderWidth(e)),l.headerWidthPx===0&&(l.headerWidthPx=e.width?e.width:e.maxWidth?e.maxWidth:e.minWidth?e.minWidth:20),l.colValueArray)return p=this.getColWidth(e,i,l.colValueArray),Math.max(l.headerWidthPx,p);let c={};c.colIndex=t,c.rowCount=this.getDataLength(),c.startIndex=0,c.endIndex=c.rowCount-1,c.valueArr=null,c.getRowVal=f=>this.getDataItem(f)[e.field];let m=(s?l.rowSelectionModeOnInit:void 0)||l.rowSelectionMode;if(m===z.FirstRow&&(c.endIndex=0),m===z.LastRow&&(c.endIndex=c.startIndex=c.rowCount-1),m===z.FirstNRows&&(c.endIndex=Math.min(l.rowSelectionCount||0,c.rowCount)-1),l.valueFilterMode===A.DeDuplicate){let f={};for(h=c.startIndex;h<=c.endIndex;h++)f[c.getRowVal(h)]=!0;if(Object.keys)c.valueArr=Object.keys(f);else{c.valueArr=[];for(let g in f)f&&c.valueArr.push(g)}c.startIndex=0,c.endIndex=c.length-1}if(l.valueFilterMode===A.GetGreatestAndSub){let f,g=0;for(h=c.startIndex;h<=c.endIndex;h++)u=c.getRowVal(h),Math.abs(u)>g&&(f=u,g=Math.abs(u));f=""+f,f=Array(f.length+1).join("9"),f=+f,c.valueArr=[f],c.startIndex=c.endIndex=0}if(l.valueFilterMode===A.GetLongestTextAndSub){for(h=c.startIndex;h<=c.endIndex;h++)u=c.getRowVal(h),(u||"").length>d&&(d=u.length);u=Array(d+1).join("m"),a=this._options.autosizeTextAvgToMWidthRatio||0,c.maxLen=d,c.valueArr=[u],c.startIndex=c.endIndex=0}if(l.valueFilterMode===A.GetLongestText){d=0;let f=0;for(h=c.startIndex;h<=c.endIndex;h++)u=c.getRowVal(h),(u||"").length>d&&(d=u.length,f=h);u=c.getRowVal(f),c.maxLen=d,c.valueArr=[u],c.startIndex=c.endIndex=0}return c.maxLen&&c.maxLen>30&&o>1&&(l.sizeToRemaining=!0),p=this.getColWidth(e,i,c)*a,Math.max(l.headerWidthPx,p)}getColWidth(e,t,i){let s=r.createDomElement("div",{className:"slick-row ui-widget-content"},t),o=r.createDomElement("div",{className:"slick-cell"},s);o.style.position="absolute",o.style.visibility="hidden",o.style.textOverflow="initial",o.style.whiteSpace="nowrap";let l,a,h=0,u="",d,p,c=e.autoSize.widthEvalMode===j.TextOnly;if(e.autoSize?.widthEvalMode===j.Auto){let m=!e.formatterOverride&&!e.formatter,f=e?.formatterOverride?.ReturnsTextOnly||!e.formatterOverride&&e.formatter?.ReturnsTextOnly;c=m||f}if(this.canvas_context&&c){let m=getComputedStyle(o);for(this.canvas_context.font=m.fontSize+" "+m.fontFamily,l=i.startIndex;l<=i.endIndex;l++)p=i.valueArr?i.valueArr[l]:i.getRowVal(l),e.formatterOverride?d=e.formatterOverride(l,i.colIndex,p,e,this.getDataItem(l),this):e.formatter?d=e.formatter(l,i.colIndex,p,e,this.getDataItem(l),this):d=""+p,a=d?this.canvas_context.measureText(d).width:0,a>h&&(h=a,u=d);return o.textContent=u,a=o.offsetWidth,s.remove(),a}for(l=i.startIndex;l<=i.endIndex;l++)p=i.valueArr?i.valueArr[l]:i.getRowVal(l),e.formatterOverride?d=e.formatterOverride(l,i.colIndex,p,e,this.getDataItem(l),this):e.formatter?d=e.formatter(l,i.colIndex,p,e,this.getDataItem(l),this):d=""+p,this.applyFormatResultToCellNode(d,o),a=o.offsetWidth,a>h&&(h=a);return s.remove(),h}getColHeaderWidth(e){let t=0,i=this.getUID()+e.id,s=document.getElementById(i),o=`${i}_`,l=s.cloneNode(!0);if(s)l.id=o,l.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",s.parentNode.insertBefore(l,s),t=l.offsetWidth,l.parentNode.removeChild(l);else{let a=this.getHeader(e);s=r.createDomElement("div",{id:o,className:"ui-state-default slick-state-default slick-header-column"},a);let h=r.createDomElement("span",{className:"slick-column-name"},s);this.applyHtmlCode(h,e.name),l.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",e.headerCssClass&&s.classList.add(...r.classNameToList(e.headerCssClass)),t=s.offsetWidth,a.removeChild(s)}return t}legacyAutosizeColumns(){let e,t,i=0,s=0,o=0,l=[],a=this.getViewportInnerWidth();for(e=0;e<this.columns.length;e++){if(t=this.columns[e],!t||t.hidden){l.push(0);continue}l.push(t.width||0),s+=t.width||0,t.resizable&&(i+=(t.width||0)-Math.max(t.minWidth||0,this.absoluteColumnMinWidth))}for(o=s;s>a&&i;){let u=(s-a)/i;for(e=0;e<this.columns.length&&s>a;e++){if(t=this.columns[e],!t||t.hidden)continue;let d=l[e];if(!t.resizable||d<=t.minWidth||d<=this.absoluteColumnMinWidth)continue;let p=Math.max(t.minWidth,this.absoluteColumnMinWidth),c=Math.floor(u*(d-p))||1;c=Math.min(c,d-p),s-=c,i-=c,l[e]-=c}if(o<=s)break;o=s}for(o=s;s<a;){let u=a/s;for(e=0;e<this.columns.length&&s<a;e++){if(t=this.columns[e],!t||t.hidden)continue;let d=l[e],p;!t.resizable||t.maxWidth<=d?p=0:p=Math.min(Math.floor(u*d)-d,t.maxWidth-d||1e6)||1,s+=p,l[e]+=s<=a?p:0}if(o>=s)break;o=s}let h=!1;for(e=0;e<this.columns.length;e++)!t||t.hidden||(this.columns[e].rerenderOnResize&&this.columns[e].width!==l[e]&&(h=!0),this.columns[e].width=l[e]);this.reRenderColumns(h)}reRenderColumns(e){this.applyColumnHeaderWidths(),this.updateCanvasWidth(!0),this.trigger(this.onAutosizeColumns,{columns:this.columns}),e&&(this.invalidateAllRows(),this.render())}getVisibleColumns(){return this.columns.filter(e=>!e.hidden)}getColumnIndex(e){return this.columnsById[e]}applyColumnHeaderWidths(){if(!this.initialized)return;let e=0,t=this.getVisibleColumns();this._headers.forEach(i=>{for(let s=0;s<i.children.length;s++,e++){let o=i.children[s],l=((t[e]||{}).width||0)-this.headerColumnWidthDiff;r.width(o)!==l&&r.width(o,l)}}),this.updateColumnCaches()}applyColumnWidths(){let e=0,t=0,i;for(let s=0;s<this.columns.length;s++)this.columns[s]?.hidden||(t=this.columns[s].width||0,i=this.getColumnCssRules(s),i.left.style.left=`${e}px`,i.right.style.right=(this._options.frozenColumn!==-1&&s>this._options.frozenColumn?this.canvasWidthR:this.canvasWidthL)-e-t+"px",this._options.frozenColumn!==s&&(e+=this.columns[s].width)),this._options.frozenColumn===s&&(e=0)}setSortColumn(e,t){this.setSortColumns([{columnId:e,sortAsc:t}])}getColumnByIndex(e){let t;return this._headers.every(i=>{let s=i.children.length;return e<s?(t=i.children[e],!1):(e-=s,!0)}),t}setSortColumns(e){this.sortColumns=e;let t=this._options.numberedMultiColumnSort&&this.sortColumns.length>1;this._headers.forEach(s=>{let o=s.querySelectorAll(".slick-header-column-sorted");o.forEach(l=>{l.classList.remove("slick-header-column-sorted")}),o=s.querySelectorAll(".slick-sort-indicator"),o.forEach(l=>{l.classList.remove("slick-sort-indicator-asc"),l.classList.remove("slick-sort-indicator-desc")}),o=s.querySelectorAll(".slick-sort-indicator-numbered"),o.forEach(l=>{l.textContent=""})});let i=1;this.sortColumns.forEach(s=>{r.isDefined(s.sortAsc)||(s.sortAsc=!0);let o=this.getColumnIndex(s.columnId);if(r.isDefined(o)){let l=this.getColumnByIndex(o);if(l){l.classList.add("slick-header-column-sorted");let a=l.querySelector(".slick-sort-indicator");a?.classList.add(s.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&(a=l.querySelector(".slick-sort-indicator-numbered"),a&&(a.textContent=String(i)))}}i++})}getColumns(){return this.columns}getSortColumns(){return this.sortColumns}updateColumnCaches(){this.columnPosLeft=[],this.columnPosRight=[];let e=0;for(let t=0,i=this.columns.length;t<i;t++)!this.columns[t]||this.columns[t].hidden||(this.columnPosLeft[t]=e,this.columnPosRight[t]=e+(this.columns[t].width||0),this._options.frozenColumn===t?e=0:e+=this.columns[t].width||0)}updateColumnProps(){this.columnsById={};for(let e=0;e<this.columns.length;e++){let t=this.columns[e];t.width&&(t.widthRequest=t.width),this._options.mixinDefaults?(r.applyDefaults(t,this._columnDefaults),t.autoSize||(t.autoSize={}),r.applyDefaults(t.autoSize,this._columnAutosizeDefaults)):(t=this.columns[e]=r.extend({},this._columnDefaults,t),t.autoSize=r.extend({},this._columnAutosizeDefaults,t.autoSize)),this.columnsById[t.id]=e,t.minWidth&&(t.width||0)<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&(t.width||0)>t.maxWidth&&(t.width=t.maxWidth)}}setColumns(e){this.trigger(this.onBeforeSetColumns,{previousColumns:this.columns,newColumns:e,grid:this}),this.columns=e,this.updateColumnsInternal(),this.trigger(this.onAfterSetColumns,{newColumns:e,grid:this})}updateColumns(){this.trigger(this.onBeforeUpdateColumns,{columns:this.columns,grid:this}),this.updateColumnsInternal()}updateColumnsInternal(){this.updateColumnProps(),this.updateColumnCaches(),this.initialized&&(this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setOverflow(),this.invalidateAllRows(),this.createColumnHeaders(),this.createColumnFooter(),this.removeCssRules(),this.createCssRules(),this.resizeCanvas(),this.updateCanvasWidth(),this.applyColumnHeaderWidths(),this.applyColumnWidths(),this.handleScroll(),this.getSelectionModel()?.refreshSelections())}getEditorLock(){return this._options.editorLock}getEditController(){return this.editController}setData(e,t){this.data=e,this.invalidateAllRows(),this.updateRowCount(),t&&this.scrollTo(0)}getData(){return this.data}getDataLength(){return this.data.getLength?this.data.getLength():this.data?.length??0}getDataLengthIncludingAddNew(){return this.getDataLength()+(this._options.enableAddRow&&(!this.pagingActive||this.pagingIsLastPage)?1:0)}getDataItem(e){return this.data.getItem?this.data.getItem(e):this.data[e]}hasDataView(){return!Array.isArray(this.data)}getItemMetadaWhenExists(e){return"getItemMetadata"in this.data?this.data.getItemMetadata(e):null}getFormatter(e,t){let i=this.data?.getItemMetadata?.(e);return(i?.columns&&(i.columns[t.id]||i.columns[this.getColumnIndex(t.id)]))?.formatter||i?.formatter||t.formatter||this._options.formatterFactory?.getFormatter(t)||this._options.defaultFormatter}getEditor(e,t){let i=this.columns[t],s=this.getItemMetadaWhenExists(e)?.columns;return s?.[i.id]?.editor!==void 0?s[i.id].editor:s?.[t]?.editor!==void 0?s[t].editor:i.editor||this._options?.editorFactory?.getEditor(i)}getDataItemValueForColumn(e,t){return this._options.dataItemColumnValueExtractor?this._options.dataItemColumnValueExtractor(e,t):e[t.field]}resetActiveCell(){this.setActiveCellInternal(null,!1)}unsetActiveCell(){r.isDefined(this.activeCellNode)&&(this.makeActiveCellNormal(),this.activeCellNode.classList.remove("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach(e=>e.classList.remove("active")))}focus(){this.setFocus()}setFocus(){this.tabbingDirection===-1?this._focusSink.focus():this._focusSink2.focus()}setActiveCellInternal(e,t,i,s,o){if(this.unsetActiveCell(),this.activeCellNode=e,r.isDefined(this.activeCellNode)){let l=r.offset(this.activeCellNode),a=Math.floor(r.offset(r.parents(this.activeCellNode,".grid-canvas")[0]).top),h=r.parents(this.activeCellNode,".grid-canvas-bottom").length;this.hasFrozenRows&&h&&(a-=this._options.frozenBottom?r.height(this._canvasTopL):this.frozenRowsHeight);let u=this.getCellFromPoint(l.left,Math.ceil(l.top)-a);this.activeRow=u.row,this.activePosY=u.row,this.activeCell=this.activePosX=this.getCellFromNode(this.activeCellNode),!r.isDefined(t)&&this._options.autoEditNewRow&&(t=this.activeRow===this.getDataLength()||this._options.autoEdit),this._options.showCellSelection&&(document.querySelectorAll(".slick-cell.active").forEach(d=>d.classList.remove("active")),this.activeCellNode.classList.add("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach(d=>d.classList.add("active"))),t&&this.isCellEditable(this.activeRow,this.activeCell)&&(this._options.asyncEditorLoading?(window.clearTimeout(this.h_editorLoader),this.h_editorLoader=window.setTimeout(()=>{this.makeActiveCellEditable(void 0,i,o)},this._options.asyncEditorLoadDelay)):this.makeActiveCellEditable(void 0,i,o))}else this.activeRow=this.activeCell=null;s||this.trigger(this.onActiveCellChanged,this.getActiveCell())}isCellEditable(e,t){return!!(this._options.editable&&this.isCellPotentiallyEditable(e,t))}isCellPotentiallyEditable(e,t){let i=this.getDataLength();return!(e<i&&!this.getDataItem(e)||this.columns[t].cannotTriggerInsert&&e>=i||!this.columns[t]||this.columns[t].hidden||!this.getEditor(e,t))}makeActiveCellNormal(e=!1){if(this.currentEditor){if(this.trigger(this.onBeforeCellEditorDestroy,{editor:this.currentEditor}),this.currentEditor.destroy(),this.currentEditor=null,this.activeCellNode){let t=this.getDataItem(this.activeRow);if(this.activeCellNode.classList.remove("editable"),this.activeCellNode.classList.remove("invalid"),t){let i=this.columns[this.activeCell],s=this.getFormatter(this.activeRow,i)(this.activeRow,this.activeCell,this.getDataItemValueForColumn(t,i),i,t,this);this.applyFormatResultToCellNode(s,this.activeCellNode),this.invalidatePostProcessingResults(this.activeRow)}e&&this.setFocus()}navigator.userAgent.toLowerCase().match(/msie/)&&this.clearTextSelection(),this.getEditorLock()?.deactivate(this.editController)}}editActiveCell(e,t,i){this.makeActiveCellEditable(e,t,i)}makeActiveCellEditable(e,t,i){if(!this.activeCellNode)return;if(!this._options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when this._options.editable is false");if(window.clearTimeout(this.h_editorLoader),!this.isCellPotentiallyEditable(this.activeRow,this.activeCell))return;let s=this.columns[this.activeCell],o=this.getDataItem(this.activeRow);if(this.trigger(this.onBeforeEditCell,{row:this.activeRow,cell:this.activeCell,item:o,column:s,target:"grid"}).getReturnValue()===!1){this.setFocus();return}this.getEditorLock()?.activate(this.editController),this.activeCellNode.classList.add("editable");let l=e||this.getEditor(this.activeRow,this.activeCell);if(!l||typeof l!="function")return;!e&&!l.suppressClearOnEdit&&r.emptyElement(this.activeCellNode);let a=this.getItemMetadaWhenExists(this.activeRow);a=a?.columns;let h=a&&(a[s.id]||a[this.activeCell]),u={grid:this,gridPosition:this.absBox(this._container),position:this.absBox(this.activeCellNode),container:this.activeCellNode,column:s,columnMetaData:h,item:o||{},event:i,commitChanges:this.commitEditAndSetFocus.bind(this),cancelChanges:this.cancelEditAndSetFocus.bind(this)};this.currentEditor=new l(u),o&&this.currentEditor&&(this.currentEditor.loadValue(o),t&&this.currentEditor?.preClick&&this.currentEditor.preClick()),this.serializedEditorValue=this.currentEditor?.serializeValue(),this.currentEditor?.position&&this.handleActiveCellPositionChange()}commitEditAndSetFocus(){this.getEditorLock()?.commitCurrentEdit()&&(this.setFocus(),this._options.autoEdit&&!this._options.autoCommitEdit&&this.navigateDown())}cancelEditAndSetFocus(){this.getEditorLock()?.cancelCurrentEdit()&&this.setFocus()}commitCurrentEdit(){let e=this,t=e.getDataItem(e.activeRow),i=e.columns[e.activeCell];if(e.currentEditor){if(e.currentEditor.isValueChanged()){let s=e.currentEditor.validate(void 0,{rowIndex:e.activeRow,cellIndex:e.activeCell});if(s.valid){let o=e.activeRow,l=e.activeCell,a=e.currentEditor,h=e.currentEditor.serializeValue(),u=e.serializedEditorValue;if(e.activeRow<e.getDataLength()){let d={row:o,cell:l,editor:a,serializedValue:h,prevSerializedValue:u,execute:()=>{a.applyValue(t,h),e.updateRow(o),e.trigger(e.onCellChange,{command:"execute",row:o,cell:l,item:t,column:i})},undo:()=>{a.applyValue(t,u),e.updateRow(o),e.trigger(e.onCellChange,{command:"undo",row:o,cell:l,item:t,column:i})}};e._options.editCommandHandler?(e.makeActiveCellNormal(!0),e._options.editCommandHandler(t,i,d)):(d.execute(),e.makeActiveCellNormal(!0))}else{let d={};e.currentEditor.applyValue(d,e.currentEditor.serializeValue()),e.makeActiveCellNormal(!0),e.trigger(e.onAddNewRow,{item:d,column:i})}return!e.getEditorLock()?.isActive()}else return e.activeCellNode&&(e.activeCellNode.classList.remove("invalid"),r.width(e.activeCellNode),e.activeCellNode.classList.add("invalid")),e.trigger(e.onValidationError,{editor:e.currentEditor,cellNode:e.activeCellNode,validationResults:s,row:e.activeRow,cell:e.activeCell,column:i}),e.currentEditor.focus(),!1}e.makeActiveCellNormal(!0)}return!0}cancelCurrentEdit(){return this.makeActiveCellNormal(),!0}getSelectedRows(){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");return this.selectedRows.slice(0)}setSelectedRows(e,t){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");this&&this.getEditorLock&&!this.getEditorLock()?.isActive()&&this.selectionModel.setSelectedRanges(this.rowsToRanges(e),t||"SlickGrid.setSelectedRows")}trigger(e,t,i){let s=i||new N(i,t),o=t||{};return o.grid=this,e.notify(o,s,this)}handleCellMouseOut(e){this.trigger(this.onMouseLeave,{},e)}handleHeaderMouseHoverOn(e){e?.target.classList.add("ui-state-hover","slick-state-hover")}handleHeaderMouseHoverOff(e){e?.target.classList.remove("ui-state-hover","slick-state-hover")}handleSelectedRangesChanged(e,t){let i=e.getNativeEvent(),s=i?.detail?.selectionMode??"",o=!!i?.detail?.addDragHandle,l=this.getSelectionModel()?.getOptions()?.selectionType;o=l==="cell"||l==="mixed";let a=this.selectedRanges.slice(0);if(this.selectedRanges=t,s===Je.Replace&&a&&a.length===1&&this.selectedRanges&&this.selectedRanges.length===1){let d=a[0],p=this.selectedRanges[0];et.copyRangeIsLarger(d,p)&&(this.trigger(this.onDragReplaceCells,{prevSelectedRange:d,selectedRange:p}),this.invalidate())}let h=this.selectedRows.slice(0);this.selectionBottomRow=-1,this.selectionRightCell=-1,this.dragReplaceEl.removeEl(),this.selectedRows=[];let u={};for(let d=0;d<t.length;d++){for(let p=t[d].fromRow;p<=t[d].toRow;p++){u[p]||(this.selectedRows.push(p),u[p]={});for(let c=t[d].fromCell;c<=t[d].toCell;c++)this.canCellBeSelected(p,c)&&(u[p][this.columns[c].id]=this._options.selectedCellCssClass)}this.selectionBottomRow<t[d].toRow&&(this.selectionBottomRow=t[d].toRow),this.selectionRightCell<t[d].toCell&&(this.selectionRightCell=t[d].toCell)}if(this.setCellCssStyles(this._options.selectedCellCssClass||"",u),this.selectionBottomRow>=0&&this.selectionRightCell>=0&&o){let d=this.getCellNode(this.selectionBottomRow,this.selectionRightCell);this.dragReplaceEl.createEl(d)}if(!this.arrayEquals(h.sort(),this.selectedRows.sort())){let d=i?.detail?.caller??"click",p=new Set(this.getSelectedRows()),c=new Set(h),m=Array.from(p).filter(g=>!c.has(g)),f=Array.from(c).filter(g=>!p.has(g));this.trigger(this.onSelectedRowsChanged,{rows:this.getSelectedRows(),previousSelectedRows:h,caller:d,changedSelectedRows:m,changedUnselectedRows:f},e)}}handleMouseWheel(e,t,i,s){this.scrollHeight=this._viewportScrollContainerY.scrollHeight,e.shiftKey?this.scrollLeft=this._viewportScrollContainerX.scrollLeft+i*10:(this.scrollTop=Math.max(0,this._viewportScrollContainerY.scrollTop-s*this._options.rowHeight),this.scrollLeft=this._viewportScrollContainerX.scrollLeft+i*10),this._handleScroll("mousewheel")&&e.stopPropagation()}handleDragInit(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;let s=this.trigger(this.onDragInit,t,e);return s.isImmediatePropagationStopped()?s.getReturnValue():!1}handleDragStart(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell)||this.currentEditor&&!this.getEditorLock().commitCurrentEdit())return!1;let s=this.trigger(this.onDragStart,t,e);return s.isImmediatePropagationStopped()?s.getReturnValue():!1}handleDrag(e,t){return this.trigger(this.onDrag,t,e).getReturnValue()}handleDragEnd(e,t){this.trigger(this.onDragEnd,t,e)}handleKeyDown(e){let t=this.trigger(this.onKeyDown,{row:this.activeRow,cell:this.activeCell},e).isImmediatePropagationStopped();if(!t&&!e.shiftKey&&!e.altKey){if(this._options.editable&&this.currentEditor?.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.ctrlKey&&e.key==="Home"?this.navigateTopStart():e.ctrlKey&&e.key==="End"?this.navigateBottomEnd():e.ctrlKey&&e.key==="ArrowUp"?this.navigateTop():e.ctrlKey&&e.key==="ArrowDown"?this.navigateBottom():e.ctrlKey&&e.key==="ArrowLeft"||!e.ctrlKey&&e.key==="Home"?this.navigateRowStart():(e.ctrlKey&&e.key==="ArrowRight"||!e.ctrlKey&&e.key==="End")&&this.navigateRowEnd()}if(!t)if(!e.shiftKey&&!e.altKey&&!e.ctrlKey){if(this._options.editable&&this.currentEditor?.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;if(e.which===L.ESCAPE){if(!this.getEditorLock()?.isActive())return;this.cancelEditAndSetFocus()}else e.which===L.PAGE_DOWN?(this.navigatePageDown(),t=!0):e.which===L.PAGE_UP?(this.navigatePageUp(),t=!0):e.which===L.LEFT?t=this.navigateLeft():e.which===L.RIGHT?t=this.navigateRight():e.which===L.UP?t=this.navigateUp():e.which===L.DOWN?t=this.navigateDown():e.which===L.TAB?t=this.navigateNext():e.which===L.ENTER&&(this._options.editable&&(this.currentEditor?this.activeRow===this.getDataLength()?this.navigateDown():this.commitEditAndSetFocus():this.getEditorLock()?.commitCurrentEdit()&&this.makeActiveCellEditable(void 0,void 0,e)),t=!0)}else e.which===L.TAB&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&(t=this.navigatePrev());let i=this.getActiveCell(),s=/^[\p{L}\p{N}\p{P}\p{S}\s]$/u.test(e.key);if(!t&&this._options.autoEditByKeypress&&i&&s&&this.isCellEditable(i.row,i.cell)&&!this.currentEditor&&this.makeActiveCellEditable(void 0,!1,e),t){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch{}}}handleClick(e){let t=e instanceof N?e.getNativeEvent():e;if(!this.currentEditor&&(t.target!==document.activeElement||t.target.classList.contains("slick-cell"))){let s=this.getTextSelection();this.setFocus(),this.setTextSelection(s)}let i=this.getCellFromEvent(t);if(!(!i||this.currentEditor!==null&&this.activeRow===i.row&&this.activeCell===i.cell)&&(e=this.trigger(this.onClick,{row:i.row,cell:i.cell},e||t),!e.isImmediatePropagationStopped()&&this.canCellBeActive(i.row,i.cell)&&(!this.getEditorLock()?.isActive()||this.getEditorLock()?.commitCurrentEdit()))){this.scrollRowIntoView(i.row,!1);let s=!!t.target?.classList?.contains(Ze),o=this.columns[i.cell],l=!!(this._options.editable&&o?.editor&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(this.getCellNode(i.row,i.cell),null,s,l,t)}}handleContextMenu(e){let t=e.target.closest(".slick-cell");t&&(this.activeCellNode===t&&this.currentEditor!==null||this.trigger(this.onContextMenu,{},e))}handleDblClick(e){let t=this.getCellFromEvent(e);!t||this.currentEditor!==null&&this.activeRow===t.row&&this.activeCell===t.cell||(this.trigger(this.onDblClick,{row:t.row,cell:t.cell},e),!e.defaultPrevented&&this._options.editable&&this.gotoCell(t.row,t.cell,!0,e))}handleHeaderMouseEnter(e){let t=r.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.trigger(this.onHeaderMouseEnter,{column:t,grid:this},e)}handleHeaderMouseLeave(e){let t=r.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.trigger(this.onHeaderMouseLeave,{column:t,grid:this},e)}handleHeaderRowMouseEnter(e){let t=r.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.trigger(this.onHeaderRowMouseEnter,{column:t,grid:this},e)}handleHeaderRowMouseLeave(e){let t=r.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.trigger(this.onHeaderRowMouseLeave,{column:t,grid:this},e)}handleHeaderContextMenu(e){let t=e.target.closest(".slick-header-column"),i=t&&r.storage.get(t,"column");this.trigger(this.onHeaderContextMenu,{column:i},e)}handleHeaderClick(e){if(!this.columnResizeDragging){let t=e.target.closest(".slick-header-column"),i=t&&r.storage.get(t,"column");i&&this.trigger(this.onHeaderClick,{column:i},e)}}handlePreHeaderContextMenu(e){this.trigger(this.onPreHeaderContextMenu,{node:e.target},e)}handlePreHeaderClick(e){this.columnResizeDragging||this.trigger(this.onPreHeaderClick,{node:e.target},e)}handleFooterContextMenu(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&r.storage.get(t,"column");this.trigger(this.onFooterContextMenu,{column:i},e)}handleFooterClick(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&r.storage.get(t,"column");this.trigger(this.onFooterClick,{column:i},e)}handleCellMouseOver(e){this.trigger(this.onMouseEnter,{},e)}handleActiveCellPositionChange(){if(this.activeCellNode&&(this.trigger(this.onActiveCellPositionChanged,{}),this.currentEditor)){let e=this.getActiveCellPosition();this.currentEditor.show&&this.currentEditor.hide&&(e.visible?this.currentEditor.show():this.currentEditor.hide()),this.currentEditor.position&&this.currentEditor.position(e)}}actionThrottle(e,t){let i=!1,s=!1,o=()=>{i?s=!0:a()},l=()=>{s=!1},a=()=>{i=!0,window.clearTimeout(this._executionBlockTimer),this._executionBlockTimer=window.setTimeout(h,t),e.call(this)},h=()=>{s?(l(),a()):i=!1};return{enqueue:o.bind(this),dequeue:l.bind(this)}}getCellFromEvent(e){let t=e instanceof N?e.getNativeEvent():e,i=t.touches?t.touches[0]:t,s=t.target.closest(".slick-cell");if(!s)return null;let o=this.getRowFromNode(s.parentNode);if(this.hasFrozenRows){let a=0,h=r.offset(r.parents(s,".grid-canvas")[0]);r.parents(s,".grid-canvas-bottom").length&&(a=this._options.frozenBottom?r.height(this._canvasTopL):this.frozenRowsHeight),o=this.getCellFromPoint(i.clientX-h.left,i.clientY-h.top+a+document.documentElement.scrollTop).row}let l=this.getCellFromNode(s);return!r.isDefined(o)||!r.isDefined(l)?null:{row:o,cell:l}}applyHtmlCode(e,t,i){if(e)if(t instanceof HTMLElement||t instanceof DocumentFragment)i?.emptyTarget!==!1&&r.emptyElement(e),e.appendChild(t);else{if(i?.skipEmptyReassignment!==!1&&!r.isDefined(t)&&!e.innerHTML)return;let s=t;typeof s=="number"||typeof s=="boolean"?e.textContent=s:(s=this.sanitizeHtmlString(t),this._options.enableHtmlRendering&&s?e.innerHTML=s:e.textContent=s)}}getCanvasNode(e,t){return this._getContainerElement(this.getCanvases(),e,t)}getActiveCanvasNode(e){return e===void 0?this._activeCanvasNode:(e instanceof N&&(e=e.getNativeEvent()),this._activeCanvasNode=e?.target.closest(".grid-canvas"),this._activeCanvasNode)}getCanvases(){return this._canvas}getViewportNode(e,t){return this._getContainerElement(this.getViewports(),e,t)}getViewports(){return this._viewport}getActiveViewportNode(e){return this.setActiveViewportNode(e),this._activeViewportNode}setActiveViewportNode(e){return e instanceof N&&(e=e.getNativeEvent()),this._activeViewportNode=e?.target.closest(".slick-viewport"),this._activeViewportNode}getHeadersWidth(){this.headersWidth=this.headersWidthL=this.headersWidthR=0;let e=!this._options.autoHeight,t=0,i=this.columns.length;for(t=0;t<i;t++){if(!this.columns[t]||this.columns[t].hidden)continue;let s=this.columns[t].width;this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=s||0:this.headersWidthL+=s||0}return e&&(this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=this.scrollbarDimensions?.width??0:this.headersWidthL+=this.scrollbarDimensions?.width??0),this.hasFrozenColumns()?(this.headersWidthL=this.headersWidthL+1e3,this.headersWidthR=Math.max(this.headersWidthR,this.viewportW)+this.headersWidthL,this.headersWidthR+=this.scrollbarDimensions?.width??0):(this.headersWidthL+=this.scrollbarDimensions?.width??0,this.headersWidthL=Math.max(this.headersWidthL,this.viewportW)+1e3),this.headersWidth=this.headersWidthL+this.headersWidthR,Math.max(this.headersWidth,this.viewportW)+1e3}getCanvasWidth(){let e=this.getViewportInnerWidth(),t=this.columns.length;for(this.canvasWidthL=this.canvasWidthR=0;t--;)!this.columns[t]||this.columns[t].hidden||(this.hasFrozenColumns()&&t>this._options.frozenColumn?this.canvasWidthR+=this.columns[t].width||0:this.canvasWidthL+=this.columns[t].width||0);let i=this.canvasWidthL+this.canvasWidthR;if(this._options.fullWidthRows){let s=Math.max(i,e)-i;s>0&&(i+=s,this.hasFrozenColumns()?this.canvasWidthR+=s:this.canvasWidthL+=s)}return i}validateColumnFreezeWidth(e=-1,t){if(e>=0){let i=0;this.columns.forEach((o,l)=>{if(!o.hidden&&l<=e){let{minWidth:a=0,maxWidth:h=0,width:u=this._options.defaultColumnWidth}=o,d=u<a?a:u;h>0&&d>h&&(d=h),i+=d}});let s=r.width(this._container)||0;if(s>0&&i>s&&!this._options.skipFreezeColumnValidation){if((t!==!1&&!this._invalidfrozenAlerted||t===!0)&&(this._options.invalidColumnFreezeWidthCallback||this._options.throwWhenFrozenNotAllViewable)){if(this._options.throwWhenFrozenNotAllViewable)throw new Error(this._options.invalidColumnFreezeWidthMessage);this._options.invalidColumnFreezeWidthCallback?.(this._options.invalidColumnFreezeWidthMessage),this._invalidfrozenAlerted=!0}return!1}}return!0}calculateFrozenColumnIndexById(e,t,i=!1){let s=this.getFrozenColumnIdx();if(t??(t=s>=0?this.columns[s]?.id:void 0),t!==void 0){let o=e.findIndex(l=>l.id===t);if(o>=0&&o!==s)return i&&this.setOptions({frozenColumn:o}),o}return s}validateSetColumnFreeze(e,t){let i=this.calculateFrozenColumnIndexById(e);return i>=0&&i>e.length-2&&!this._options.skipFreezeColumnValidation?((t!==!1&&!this._invalidfrozenAlerted||t===!0)&&(this._options.invalidColumnFreezePickerCallback?.(this._options.invalidColumnFreezePickerMessage),this._invalidfrozenAlerted=!0),!1):!0}updateCanvasWidth(e){let t=this.canvasWidth,i=this.canvasWidthL,s=this.canvasWidthR;this.canvasWidth=this.getCanvasWidth(),this._options.createTopHeaderPanel&&r.width(this._topHeaderPanel,this._options.topHeaderPanelWidth??this.canvasWidth);let o=this.canvasWidth!==t||this.canvasWidthL!==i||this.canvasWidthR!==s;(o||this.hasFrozenColumns()||this.hasFrozenRows)&&(r.width(this._canvasTopL,this.canvasWidthL),this.getHeadersWidth(),r.width(this._headerL,this.headersWidthL),r.width(this._headerR,this.headersWidthR),this.hasFrozenColumns()?(r.width(this._canvasTopR,this.canvasWidthR),r.width(this._paneHeaderL,this.canvasWidthL),r.setStyleSize(this._paneHeaderR,"left",this.canvasWidthL),r.setStyleSize(this._paneHeaderR,"width",this.viewportW-this.canvasWidthL),r.width(this._paneTopL,this.canvasWidthL),r.setStyleSize(this._paneTopR,"left",this.canvasWidthL),r.width(this._paneTopR,this.viewportW-this.canvasWidthL),r.width(this._headerRowScrollerL,this.canvasWidthL),r.width(this._headerRowScrollerR,this.viewportW-this.canvasWidthL),r.width(this._headerRowL,this.canvasWidthL),r.width(this._headerRowR,this.canvasWidthR),this._options.createFooterRow&&(r.width(this._footerRowScrollerL,this.canvasWidthL),r.width(this._footerRowScrollerR,this.viewportW-this.canvasWidthL),r.width(this._footerRowL,this.canvasWidthL),r.width(this._footerRowR,this.canvasWidthR)),this._options.createPreHeaderPanel&&r.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),r.width(this._viewportTopL,this.canvasWidthL),r.width(this._viewportTopR,this.viewportW-this.canvasWidthL),this.hasFrozenRows&&(r.width(this._paneBottomL,this.canvasWidthL),r.setStyleSize(this._paneBottomR,"left",this.canvasWidthL),r.width(this._viewportBottomL,this.canvasWidthL),r.width(this._viewportBottomR,this.viewportW-this.canvasWidthL),r.width(this._canvasBottomL,this.canvasWidthL),r.width(this._canvasBottomR,this.canvasWidthR))):(r.width(this._paneHeaderL,"100%"),r.width(this._paneTopL,"100%"),r.width(this._headerRowScrollerL,"100%"),r.width(this._headerRowL,this.canvasWidth),this._options.createFooterRow&&(r.width(this._footerRowScrollerL,"100%"),r.width(this._footerRowL,this.canvasWidth)),this._options.createPreHeaderPanel&&r.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),r.width(this._viewportTopL,"100%"),this.hasFrozenRows&&(r.width(this._viewportBottomL,"100%"),r.width(this._canvasBottomL,this.canvasWidthL)))),this.viewportHasHScroll=this.canvasWidth>=this.viewportW-(this.scrollbarDimensions?.width??0),r.width(this._headerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll?this.scrollbarDimensions?.width??0:0)),r.width(this._headerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll?this.scrollbarDimensions?.width??0:0)),this._options.createFooterRow&&(r.width(this._footerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll?this.scrollbarDimensions?.width??0:0)),r.width(this._footerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll?this.scrollbarDimensions?.width??0:0))),(o||e)&&this.applyColumnWidths()}getPreHeaderPanel(){return this._preHeaderPanel}getPreHeaderPanelLeft(){return this._preHeaderPanel}getPreHeaderPanelRight(){return this._preHeaderPanelR}getTopHeaderPanel(){return this._topHeaderPanel}setPaneVisibility(){this.hasFrozenColumns()?(r.show(this._paneHeaderR),r.show(this._paneTopR),this.hasFrozenRows?(r.show(this._paneBottomL),r.show(this._paneBottomR)):(r.hide(this._paneBottomR),r.hide(this._paneBottomL))):(r.hide(this._paneHeaderR),r.hide(this._paneTopR),r.hide(this._paneBottomR),this.hasFrozenRows?r.show(this._paneBottomL):(r.hide(this._paneBottomR),r.hide(this._paneBottomL)))}setOverflow(){if(this._viewportTopL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportTopR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?this.hasFrozenRows?"scroll":"auto":this.hasFrozenRows?"scroll":"auto",this._viewportBottomL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportBottomR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"auto"):(this.hasFrozenRows,"auto"),this._options.viewportClass){let e=r.classNameToList(this._options.viewportClass);this._viewportTopL.classList.add(...e),this._viewportTopR.classList.add(...e),this._viewportBottomL.classList.add(...e),this._viewportBottomR.classList.add(...e)}}createCssRules(){this._style=document.createElement("style"),this._style.nonce=this._options.nonce||"",(this._options.shadowRoot||document.head).appendChild(this._style);let e=this._options.rowHeight-this.cellHeightDiff,t=[`.${this.uid} .slick-group-header-column { left: 1000px; }`,`.${this.uid} .slick-header-column { left: 1000px; }`,`.${this.uid} .slick-top-panel { height: ${this._options.topPanelHeight}px; }`,`.${this.uid} .slick-preheader-panel { height: ${this._options.preHeaderPanelHeight}px; }`,`.${this.uid} .slick-topheader-panel { height: ${this._options.topHeaderPanelHeight}px; }`,`.${this.uid} .slick-headerrow-columns { height: ${this._options.headerRowHeight}px; }`,`.${this.uid} .slick-footerrow-columns { height: ${this._options.footerRowHeight}px; }`,`.${this.uid} .slick-cell { height: ${e}px; }`,`.${this.uid} .slick-row { height: ${this._options.rowHeight}px; }`],i=this._style.sheet;if(i){t.forEach(s=>{i.insertRule(s)});for(let s=0;s<this.columns.length;s++)!this.columns[s]||this.columns[s].hidden||(i.insertRule(`.${this.uid} .l${s} { }`),i.insertRule(`.${this.uid} .r${s} { }`))}else this.createCssRulesAlternative(t)}createCssRulesAlternative(e){let t=document.createElement("template");t.innerHTML='<style type="text/css" rel="stylesheet" />',this._style=t.content.firstChild,(this._options.shadowRoot||document.head).appendChild(this._style);for(let i=0;i<this.columns.length;i++)!this.columns[i]||this.columns[i].hidden||(e.push(`.${this.uid} .l${i} { }`),e.push(`.${this.uid} .r${i} { }`));this._style.styleSheet?this._style.styleSheet.cssText=e.join(" "):this._style.appendChild(document.createTextNode(e.join(" ")))}getColumnCssRules(e){let t;if(!this.stylesheet){let i=(this._options.shadowRoot||document).styleSheets;for(this._options.devMode&&typeof this._options.devMode?.ownerNodeIndex=="number"&&this._options.devMode.ownerNodeIndex>=0&&(i[this._options.devMode.ownerNodeIndex].ownerNode=this._style),t=0;t<i.length;t++)if((i[t].ownerNode||i[t].owningElement)===this._style){this.stylesheet=i[t];break}if(!this.stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");this.columnCssRulesL=[],this.columnCssRulesR=[];let s=this.stylesheet.cssRules||this.stylesheet.rules,o,l;for(t=0;t<s.length;t++){let a=s[t].selectorText;(o=/\.l\d+/.exec(a))?(l=parseInt(o[0].substr(2,o[0].length-2),10),this.columnCssRulesL[l]=s[t]):(o=/\.r\d+/.exec(a))&&(l=parseInt(o[0].substr(2,o[0].length-2),10),this.columnCssRulesR[l]=s[t])}}return{left:this.columnCssRulesL[e],right:this.columnCssRulesR[e]}}removeCssRules(){this._style?.remove(),this.stylesheet=null}getTopPanel(){return this._topPanels[0]}getTopPanels(){return this._topPanels}togglePanelVisibility(e,t,i,s){let o=s!==!1;if(this._options[e]!==i)if(this._options[e]=i,i){if(o){r.slideDown(t,this.resizeCanvas.bind(this));return}r.show(t),this.resizeCanvas()}else{if(o){r.slideUp(t,this.resizeCanvas.bind(this));return}r.hide(t),this.resizeCanvas()}}setTopPanelVisibility(e,t){this.togglePanelVisibility("showTopPanel",this._topPanelScrollers,e,t)}setHeaderRowVisibility(e,t){this.togglePanelVisibility("showHeaderRow",this._headerRowScroller,e,t)}setColumnHeaderVisibility(e,t){this.togglePanelVisibility("showColumnHeader",this._headerScroller,e,t)}setFooterRowVisibility(e,t){this.togglePanelVisibility("showFooterRow",this._footerRowScroller,e,t)}setPreHeaderPanelVisibility(e,t){this.togglePanelVisibility("showPreHeaderPanel",[this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],e,t)}setTopHeaderPanelVisibility(e){this.togglePanelVisibility("showTopHeaderPanel",this._topHeaderPanelScroller,e)}getRowHeight(){return this._options.rowHeight}getRowTop(e){return Math.round(this._options.rowHeight*e-this.offset)}getRowBottom(e){return this.getRowTop(e)+this._options.rowHeight}getRowFromPosition(e){return Math.floor((e+this.offset)/this._options.rowHeight)}appendRowHtml(e,t,i,s,o){let l=this.getDataItem(i),a=i<o&&!l,h="slick-row"+(this.hasFrozenRows&&i<=this._options.frozenRow?" frozen":"")+(a?" loading":"")+(i===this.activeRow&&this._options.showCellSelection?" active":"")+(i%2===1?" odd":" even");l||(h+=` ${this._options.addNewRowCssClass}`);let u=this.getItemMetadaWhenExists(i);u?.cssClasses&&(h+=` ${u.cssClasses}`);let d=r.createDomElement("div",{className:`ui-widget-content ${h}`,role:"row",dataset:{row:`${i}`}}),p=this.getFrozenRowOffset(i),c=this.getRowTop(i)-p;this._options.rowTopOffsetRenderType==="transform"?d.style.transform=`translateY(${c}px)`:d.style.top=`${c}px`;let m;e.push(d),this.hasFrozenColumns()&&(m=d.cloneNode(!0),t.push(m));let f=this.columns.length,g,C,b,v,R=!0;for(let w=0,S=f;w<S;w++){if(R=!0,v=this.columns[w],!v||v.hidden)continue;C=1,b=1,g=null,u?.columns&&(g=u.columns[v.id]||u.columns[w],C=g?.colspan||1,b=g?.rowspan||1,C==="*"&&(C=S-w),b>o-i&&(b=o-i)),!this._options.enableCellRowSpan&&b>1&&console.warn('[SlickGrid] Cell "rowspan" is an opt-in grid option because of its small perf hit, you must enable it via the "enableCellRowSpan" grid option.');let y=C;if(!this.getParentRowSpanByCell(i,w)){if(this.columnPosRight[Math.min(S-1,w+y-1)]>s.leftPx){if(!v.alwaysRenderColumn&&this.columnPosLeft[w]>s.rightPx&&(R=!1),R){let E=this.hasFrozenColumns()&&w>this._options.frozenColumn?m:d;this.appendCellHtml(E,i,w,y,b,g,l)}}else(v.alwaysRenderColumn||this.hasFrozenColumns()&&w<=this._options.frozenColumn)&&this.appendCellHtml(d,i,w,y,b,g,l);y>1&&(w+=y-1)}}}appendCellHtml(e,t,i,s,o,l,a){let h=this.columns[i],u=`slick-cell l${i} r${Math.min(this.columns.length-1,i+s-1)}`+(h.cssClass?` ${h.cssClass}`:"")+(o>1?" rowspan":"")+(l?.cssClass?` ${l.cssClass}`:"");this.hasFrozenColumns()&&i<=this._options.frozenColumn&&(u+=" frozen"),t===this.activeRow&&i===this.activeCell&&this._options.showCellSelection&&(u+=" active"),Object.keys(this.cellCssClasses).forEach(b=>{this.cellCssClasses[b][t]?.[h.id]&&(u+=` ${this.cellCssClasses[b][t][h.id]}`)});let d=null,p="";a&&(d=this.getDataItemValueForColumn(a,h),p=this.getFormatter(t,h)(t,i,d,h,a,this),p==null&&(p=""));let c=this.trigger(this.onBeforeAppendCell,{row:t,cell:i,value:d,dataContext:a}).getReturnValue(),m=typeof c=="string"?c:"";p?.addClasses&&(m+=r.classNameToList((m?" ":"")+p.addClasses).join(" "));let f=p?.toolTip?`${p.toolTip}`:"",g=r.createDomElement("div",{className:r.classNameToList(`${u} ${m||""}`).join(" "),role:"gridcell",tabIndex:-1});g.setAttribute("aria-describedby",this.uid+h.id),f&&g.setAttribute("title",f);let C=this.getCellHeight(t,o);if(o>1&&C!==this._options.rowHeight-this.cellHeightDiff&&(g.style.height=`${C||0}px`),h.hasOwnProperty("cellAttrs")&&h.cellAttrs instanceof Object&&Object.keys(h.cellAttrs).forEach(b=>{h.cellAttrs.hasOwnProperty(b)&&g.setAttribute(b,h.cellAttrs[b])}),a){let b=Object.prototype.toString.call(p)!=="[object Object]"?p:p.html||p.text;this.applyHtmlCode(g,b);let v=this.getSelectionModel()?.getOptions()?.selectionType,R=v==="cell"||v==="mixed";t===this.selectionBottomRow&&i===this.selectionRightCell&&this._options.showCellSelection&&R&&this.dragReplaceEl.createEl(g)}e.appendChild(g),p.insertElementAfterTarget&&r.insertAfterElement(g,p.insertElementAfterTarget),this.rowsCache[t].cellRenderQueue.push(i),this.rowsCache[t].cellColSpans[i]=s}cleanupRows(e){let t=new Set;if(this._options.enableCellRowSpan)for(let i=e.top,s=e.bottom;i<=s;i++){let o=this.getRowSpanIntersect(i);o!==null&&t.add(o)}Object.keys(this.rowsCache).forEach(i=>{if(this.rowsCache){let s=+i,o=!0;this.hasFrozenRows&&(this._options.frozenBottom&&s>=this.actualFrozenRow||!this._options.frozenBottom&&s<=this.actualFrozenRow)&&(o=!1),(s=parseInt(i,10))!==this.activeRow&&(s<e.top||s>e.bottom)&&o&&!t.has(s)&&this.removeRowFromCache(s)}}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidate(){this.updateRowCount(),this.invalidateAllRows(),this.render()}invalidateAllRows(){this.currentEditor&&this.makeActiveCellNormal(),typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(e=>{this.rowsCache&&this.removeRowFromCache(+e)}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidateRows(e){if(!e||!e.length)return;let t;this.vScrollDir=0;let i=e.length,s=new Set,o=new Set,l=e.length>this._options.maxPartialRowSpanRemap||e.length===this.getDataLength()||this._prevInvalidatedRowsCount+e.length===this.getDataLength();for(let a=0;a<i;a++)if(t=e[a],this.currentEditor&&this.activeRow===t&&this.makeActiveCellNormal(),this.rowsCache[t]&&this.removeRowFromCache(t),this._options.enableCellRowSpan&&!l){s.add(t);let h=this.getRowSpanIntersect(t);h!==null&&s.add(h)}if(this._options.enableCellRowSpan&&!l){for(let a of Array.from(s)){let h=this.getRowSpanColumnIntersects(a);for(let u of h){let d=this.getParentRowSpanByCell(a,u);d&&this._colsWithRowSpanCache[u]&&(this._colsWithRowSpanCache[u].delete(d.range),o.add(d.range.split(":").map(Number)[0]))}}for(let a of Array.from(o))this.remapRowSpanMetadataByRow(a)}this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this._prevInvalidatedRowsCount=e.length}invalidateRow(e){if(e>=0){let t=[e];if(this._options.enableCellRowSpan){let i=this.getRowSpanIntersect(e);i!==null&&t.push(i)}this.invalidateRows(t)}}removeRowFromCache(e){let t=this.rowsCache[e];t?.rowNode&&(this.trigger(this.onBeforeRemoveCachedRow,{row:e}),this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[e]?this.queuePostProcessedRowForCleanup(t,this.postProcessedRows[e],e):t.rowNode?.forEach(i=>i.parentElement?.removeChild(i)),delete this.rowsCache[e],delete this.postProcessedRows[e],this.renderedRows--,this.counter_rows_removed++)}updateCell(e,t){let i=this.getCellNode(e,t);if(!i)return;let s=this.columns[t],o=this.getDataItem(e);if(this.currentEditor&&this.activeRow===e&&this.activeCell===t)this.currentEditor.loadValue(o);else{let l=o?this.getFormatter(e,s)(e,t,this.getDataItemValueForColumn(o,s),s,o,this):"";this.applyFormatResultToCellNode(l,i),this.invalidatePostProcessingResults(e)}}updateRow(e){let t=this.rowsCache[e];if(!t)return;this.ensureCellNodesInRowsCache(e);let i,s=this.getDataItem(e);Object.keys(t.cellNodesByColumnIdx).forEach(o=>{if(!t.cellNodesByColumnIdx.hasOwnProperty(o))return;let l=+o,a=this.columns[l],h=t.cellNodesByColumnIdx[l];e===this.activeRow&&l===this.activeCell&&this.currentEditor?this.currentEditor.loadValue(s):s?(i=this.getFormatter(e,a)(e,l,this.getDataItemValueForColumn(s,a),a,s,this),this.applyFormatResultToCellNode(i,h)):r.emptyElement(h)}),this.invalidatePostProcessingResults(e)}getViewportRowCount(){let e=this.getViewportHeight(),t=this.getScrollbarDimensions()?.height??0;return Math.floor((e-t)/this._options.rowHeight)}getViewportHeight(){if((!this._options.autoHeight||this._options.frozenColumn!==-1)&&(this.topPanelH=this._options.showTopPanel?this._options.topPanelHeight+this.getVBoxDelta(this._topPanelScrollers[0]):0,this.headerRowH=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,this.footerRowH=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0),this._options.autoHeight){let e=this._paneHeaderL.offsetHeight;e+=this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,e+=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,e+=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0,e+=this.getCanvasWidth()>this.viewportW?this.scrollbarDimensions?.height??0:0,this.viewportH=this._options.rowHeight*this.getDataLengthIncludingAddNew()+(this._options.frozenColumn===-1?e:0)}else{let e=getComputedStyle(this._container),t=e.boxSizing!=="content-box"?this.getVBoxDelta(this._container):0,i=this._options.createTopHeaderPanel&&this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight+this.getVBoxDelta(this._topHeaderPanelScroller):0,s=this._options.createPreHeaderPanel&&this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,o=this._options.showColumnHeader?r.toFloat(r.height(this._headerScroller[0])):0;this.viewportH=r.toFloat(e.height)-r.toFloat(e.paddingTop)-r.toFloat(e.paddingBottom)-this.topPanelH-i-s-this.headerRowH-o-this.footerRowH-t}return this.numVisibleRows=Math.ceil(this.viewportH/this._options.rowHeight),this.viewportH}getViewportInnerWidth(){return this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW}getViewportWidth(){return this.viewportW=parseFloat(r.innerSize(this._container,"width"))||this._options.devMode&&this._options.devMode.containerClientWidth||0,this.viewportW}resizeCanvas(){if(!this.initialized)return;if(this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.getViewportWidth(),this.getViewportHeight(),this.hasFrozenRows?this._options.frozenBottom?(this.paneTopH=this.viewportH-this.frozenRowsHeight-(this.scrollbarDimensions?.height??0),this.paneBottomH=this.frozenRowsHeight+(this.scrollbarDimensions?.height??0)):(this.paneTopH=this.frozenRowsHeight,this.paneBottomH=this.viewportH-this.frozenRowsHeight):this.paneTopH=this.viewportH,this.paneTopH+=this.topPanelH+this.headerRowH+this.footerRowH,this.hasFrozenColumns()&&this._options.autoHeight&&(this.paneTopH+=this.scrollbarDimensions?.height??0),this.viewportTopH=this.paneTopH-this.topPanelH-this.headerRowH-this.footerRowH,this._options.autoHeight){if(this.hasFrozenColumns()){let i=this.paneTopH+this._headerScrollerL.offsetHeight;i+=this.getVBoxDelta(this._container),this._options.showPreHeaderPanel&&(i+=this._options.preHeaderPanelHeight),r.height(this._container,i)}this._paneTopL.style.position="relative"}let e=r.height(this._paneHeaderL);e?e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0:e=(this._options.showHeaderRow?this._options.headerRowHeight:0)+(this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight:0),r.setStyleSize(this._paneTopL,"top",e||e),r.height(this._paneTopL,this.paneTopH);let t=this._paneTopL.offsetTop+this.paneTopH;if(this._options.autoHeight||r.height(this._viewportTopL,this.viewportTopH),this.hasFrozenColumns()){let i=r.height(this._paneHeaderL);i&&(i+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0),r.setStyleSize(this._paneTopR,"top",i),r.height(this._paneTopR,this.paneTopH),r.height(this._viewportTopR,this.viewportTopH),this.hasFrozenRows&&(r.setStyleSize(this._paneBottomL,"top",t),r.height(this._paneBottomL,this.paneBottomH),r.setStyleSize(this._paneBottomR,"top",t),r.height(this._paneBottomR,this.paneBottomH),r.height(this._viewportBottomR,this.paneBottomH))}else this.hasFrozenRows&&(r.width(this._paneBottomL,"100%"),r.height(this._paneBottomL,this.paneBottomH),r.setStyleSize(this._paneBottomL,"top",t));this.hasFrozenRows?(r.height(this._viewportBottomL,this.paneBottomH),this._options.frozenBottom?(r.height(this._canvasBottomL,this.frozenRowsHeight),this.hasFrozenColumns()&&r.height(this._canvasBottomR,this.frozenRowsHeight)):(r.height(this._canvasTopL,this.frozenRowsHeight),this.hasFrozenColumns()&&r.height(this._canvasTopR,this.frozenRowsHeight))):r.height(this._viewportTopR,this.viewportTopH),(!this.scrollbarDimensions||!this.scrollbarDimensions.width)&&(this.scrollbarDimensions=this.measureScrollbar()),this._options.autosizeColsMode===P.LegacyForceFit&&this.autosizeColumns(),this.updateRowCount(),this.handleScroll(),this.lastRenderedScrollLeft=-1,this.render()}updateRowCount(){if(!this.initialized)return;let e=this.getDataLength();e>0&&e!==this._prevDataLength&&(this._rowSpanIsCached=!1),this._options.enableCellRowSpan&&!this._rowSpanIsCached&&this.remapAllColumnsRowSpan(),this._prevDataLength=e;let t=this.getDataLengthIncludingAddNew(),i=0,s=this.hasFrozenRows&&!this._options.frozenBottom?r.height(this._canvasBottomL):r.height(this._canvasTopL);this.hasFrozenRows?i=this.getDataLength()-this._options.frozenRow:i=t+(this._options.leaveSpaceForNewRows?this.numVisibleRows-1:0);let o=r.height(this._viewportScrollContainerY),l=this.viewportHasVScroll;this.viewportHasVScroll=this._options.alwaysShowVerticalScroll||!this._options.autoHeight&&i*this._options.rowHeight>o,this.makeActiveCellNormal();let a=e-1;typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(u=>{let d=+u;d>a&&this.removeRowFromCache(d)}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this.activeCellNode&&this.activeRow>a&&this.resetActiveCell(),s=this.h,this._options.autoHeight?this.h=this._options.rowHeight*i:(this.th=Math.max(this._options.rowHeight*i,o-(this.scrollbarDimensions?.height??0)),this.th<this.maxSupportedCssHeight?(this.h=this.ph=this.th,this.n=1,this.cj=0):(this.h=this.maxSupportedCssHeight,this.ph=this.h/100,this.n=Math.floor(this.th/this.ph),this.cj=(this.th-this.h)/(this.n-1))),(this.h!==s||this.enforceFrozenRowHeightRecalc)&&(this.hasFrozenRows&&!this._options.frozenBottom?(r.height(this._canvasBottomL,this.h),this.hasFrozenColumns()&&r.height(this._canvasBottomR,this.h)):(r.height(this._canvasTopL,this.h),r.height(this._canvasTopR,this.h)),this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.enforceFrozenRowHeightRecalc=!1);let h=this.scrollTop+this.offset<=this.th-o;this.th===0||this.scrollTop===0?this.page=this.offset=0:h?this.scrollTo(this.scrollTop+this.offset):this.scrollTo(this.th-o+(this.scrollbarDimensions?.height??0)),this.h!==s&&this._options.autoHeight&&this.resizeCanvas(),this._options.autosizeColsMode===P.LegacyForceFit&&l!==this.viewportHasVScroll&&this.autosizeColumns(),this.updateCanvasWidth(!1)}getViewport(e,t){return this.getVisibleRange(e,t)}getVisibleRange(e,t){return e??(e=this.scrollTop),t??(t=this.scrollLeft),{top:this.getRowFromPosition(e),bottom:this.getRowFromPosition(e+this.viewportH)+1,leftPx:t,rightPx:t+this.viewportW}}getRenderedRange(e,t){let i=this.getVisibleRange(e,t),s=Math.round(this.viewportH/this._options.rowHeight),o=this._options.minRowBuffer;return this.vScrollDir===-1?(i.top-=s,i.bottom+=o):this.vScrollDir===1?(i.top-=o,i.bottom+=s):(i.top-=o,i.bottom+=o),i.top=Math.max(0,i.top),i.bottom=Math.min(this.getDataLengthIncludingAddNew()-1,i.bottom),i.leftPx-=this.viewportW,i.rightPx+=this.viewportW,i.leftPx=Math.max(0,i.leftPx),i.rightPx=Math.min(this.canvasWidth,i.rightPx),i}getRowCache(){return this.rowsCache}ensureCellNodesInRowsCache(e){let t=this.rowsCache[e];if(t?.cellRenderQueue.length&&t.rowNode?.length){let i=t.rowNode,s=Array.from(i[0].children);i.length>1&&(s=s.concat(Array.from(i[1].children)));let o=s.length-1;for(;t.cellRenderQueue.length;){let l=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[l]=s[o--]}}}cleanUpCells(e,t){if(this.hasFrozenRows&&(this._options.frozenBottom&&t>this.actualFrozenRow||t<=this.actualFrozenRow))return;let i=0,s=this.rowsCache[t],o=[];Object.keys(s.cellNodesByColumnIdx).forEach(h=>{if(!s.cellNodesByColumnIdx.hasOwnProperty(h))return;let u=+h;if(u<=this._options.frozenColumn||Array.isArray(this.columns)&&this.columns[u]?.alwaysRenderColumn)return;let d=s.cellColSpans[u];(this.columnPosLeft[u]>e.rightPx||this.columnPosRight[Math.min(this.columns.length-1,(u||0)+d-1)]<e.leftPx)&&(t===this.activeRow&&Number(u)===this.activeCell||o.push(u))});let l,a;for(;r.isDefined(l=o.pop());)a=s.cellNodesByColumnIdx[l],this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[t]?.[l]?this.queuePostProcessedCellForCleanup(a,l,t):a.parentElement?.removeChild(a),delete s.cellColSpans[l],delete s.cellNodesByColumnIdx[l],this.postProcessedRows[t]&&delete this.postProcessedRows[t][l],i++}cleanUpAndRenderCells(e){let t,i=document.createElement("div"),s=[],o,l=0,a,h,u=this.columns.length;for(let c=e.top,m=e.bottom;c<=m;c++){if(t=this.rowsCache[c],!t)continue;this.ensureCellNodesInRowsCache(c),(!this._options.enableCellRowSpan||this.getRowSpanIntersect(c)===null)&&this.cleanUpCells(e,c),o=0;let f=this.getItemMetadaWhenExists(c);f=f?.columns;let g=this.getDataItem(c);for(let C=0,b=u;C<b;C++){if(!this.columns[C]||this.columns[C].hidden)continue;if(this.columnPosLeft[C]>e.rightPx)break;if(r.isDefined(a=t.cellColSpans[C])){C+=a>1?a-1:0;continue}a=1,h=null,f&&(h=f[this.columns[C].id]||f[C],a=h?.colspan??1,a==="*"&&(a=b-C));let v=a;if(!this.getParentRowSpanByCell(c,C)){if(this.columnPosRight[Math.min(b-1,C+v-1)]>e.leftPx){let R=this.getRowspan(c,C);this.appendCellHtml(i,c,C,v,R,h,g),o++}C+=v>1?v-1:0}}o&&(l+=o,s.push(c))}if(!i.children.length)return;let d,p;for(;r.isDefined(d=s.pop());){t=this.rowsCache[d];let c;for(;r.isDefined(c=t.cellRenderQueue.pop());)p=i.lastChild,p&&(this.hasFrozenColumns()&&c>this._options.frozenColumn?t.rowNode[1].appendChild(p):t.rowNode[0].appendChild(p),t.cellNodesByColumnIdx[c]=p)}}renderRows(e){let t=[],i=[],s=[],o=!1,l=this.getDataLength(),a=new Set,h=new Set;for(let d=e.top,p=e.bottom;d<=p;d++)if(!(this.rowsCache[d]||this.hasFrozenRows&&this._options.frozenBottom&&d===this.getDataLength())){if(this.renderedRows++,s.push(d),h.add(d),this.rowsCache[d]=this.createEmptyCachingRow(),this._options.enableCellRowSpan){let c=this.getRowSpanIntersect(d);c!==null&&h.add(c)}this.appendRowHtml(t,i,d,e,l),a.add(d),this.activeCellNode&&this.activeRow===d&&(o=!0),this.counter_rows_rendered++}let u=this.setDifference(h,a);if(u.size>0&&u.forEach(d=>{this.removeRowFromCache(d),s.push(d),this.rowsCache[d]=this.createEmptyCachingRow(),this.appendRowHtml(t,i,d,e,l)}),s.length){let d=document.createElement("div"),p=document.createElement("div");t.forEach(c=>d.appendChild(c)),i.forEach(c=>p.appendChild(c));for(let c=0,m=s.length;c<m;c++)this.hasFrozenRows&&s[c]>=this.actualFrozenRow?this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(s[c])&&d.firstChild&&p.firstChild&&(this.rowsCache[s[c]].rowNode=[d.firstChild,p.firstChild],this._canvasBottomL.appendChild(d.firstChild),this._canvasBottomR.appendChild(p.firstChild)):this.rowsCache?.hasOwnProperty(s[c])&&d.firstChild&&(this.rowsCache[s[c]].rowNode=[d.firstChild],this._canvasBottomL.appendChild(d.firstChild)):this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(s[c])&&d.firstChild&&p.firstChild&&(this.rowsCache[s[c]].rowNode=[d.firstChild,p.firstChild],this._canvasTopL.appendChild(d.firstChild),this._canvasTopR.appendChild(p.firstChild)):this.rowsCache?.hasOwnProperty(s[c])&&d.firstChild&&(this.rowsCache[s[c]].rowNode=[d.firstChild],this._canvasTopL.appendChild(d.firstChild));o&&(this.activeCellNode=this.getCellNode(this.activeRow,this.activeCell))}}updateRowPositions(){for(let e in this.rowsCache)if(this.rowsCache){let t=e?parseInt(e,10):0,i=this.rowsCache[t].rowNode[0];this._options.rowTopOffsetRenderType==="transform"?i.style.transform=`translateY(${this.getRowTop(t)}px)`:i.style.top=`${this.getRowTop(t)}px`}}render(){if(!this.initialized)return;this.scrollThrottle.dequeue();let e=this.getVisibleRange(),t=this.getRenderedRange();if(this.cleanupRows(t),this.lastRenderedScrollLeft!==this.scrollLeft){if(this.hasFrozenRows){let i=r.extend(!0,{},t);this._options.frozenBottom?(i.top=this.actualFrozenRow,i.bottom=this.getDataLength()):(i.top=0,i.bottom=this._options.frozenRow),this.cleanUpAndRenderCells(i)}this.cleanUpAndRenderCells(t)}this.renderRows(t),this.hasFrozenRows&&(this._options.frozenBottom?this.renderRows({top:this.actualFrozenRow,bottom:this.getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):this.renderRows({top:0,bottom:this._options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),this.postProcessFromRow=e.top,this.postProcessToRow=Math.min(this.getDataLengthIncludingAddNew()-1,e.bottom),this.startPostProcessing(),this.lastRenderedScrollTop=this.scrollTop,this.lastRenderedScrollLeft=this.scrollLeft,this.trigger(this.onRendered,{startRow:e.top,endRow:e.bottom,grid:this})}getFrozenRowOffset(e){let t=0;return this.hasFrozenRows?this._options.frozenBottom?e>=this.actualFrozenRow?this.h<this.viewportTopH?t=this.actualFrozenRow*this._options.rowHeight:t=this.h:t=0:e>=this.actualFrozenRow?t=this.frozenRowsHeight:t=0:t=0,t}bindAncestorScrollEvents(){let e=this.hasFrozenRows&&!this._options.frozenBottom?this._canvasBottomL:this._canvasTopL;for(;(e=e.parentNode)!==document.body&&e;)(e===this._viewportTopL||e.scrollWidth!==e.clientWidth||e.scrollHeight!==e.clientHeight)&&(this._boundAncestors.push(e),this._bindingEventService.bind(e,"scroll",this.handleActiveCellPositionChange.bind(this)))}unbindAncestorScrollEvents(){this._boundAncestors.forEach(e=>{this._bindingEventService.unbindByEventName(e,"scroll")}),this._boundAncestors=[]}setScroller(){this.hasFrozenColumns()?(this._headerScrollContainer=this._headerScrollerR,this._headerRowScrollContainer=this._headerRowScrollerR,this._footerRowScrollContainer=this._footerRowScrollerR,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomR,this._viewportScrollContainerY=this._viewportTopR):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomR:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopR):(this._headerScrollContainer=this._headerScrollerL,this._headerRowScrollContainer=this._headerRowScrollerL,this._footerRowScrollContainer=this._footerRowScrollerL,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomL,this._viewportScrollContainerY=this._viewportTopL):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomL:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopL)}scrollTo(e){e=Math.max(e,0),e=Math.min(e,(this.th||0)-r.height(this._viewportScrollContainerY)+(this.viewportHasHScroll||this.hasFrozenColumns()?this.scrollbarDimensions?.height??0:0));let t=this.offset;this.offset=Math.round(this.page*(this.cj||0)),this.page=Math.min((this.n||0)-1,Math.floor(e/(this.ph||0)));let i=e-this.offset;if(this.offset!==t){let s=this.getVisibleRange(i);this.cleanupRows(s),this.updateRowPositions()}this.prevScrollTop!==i&&(this.vScrollDir=this.prevScrollTop+t<i+this.offset?1:-1,this.lastRenderedScrollTop=this.scrollTop=this.prevScrollTop=i,this.hasFrozenColumns()&&(this._viewportTopL.scrollTop=i),this.hasFrozenRows&&(this._viewportBottomL.scrollTop=this._viewportBottomR.scrollTop=i),this._viewportScrollContainerY&&(this._viewportScrollContainerY.scrollTop=i),this.trigger(this.onViewportChanged,{}))}handleHeaderRowScroll(){let e=this._headerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handleFooterRowScroll(){let e=this._footerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handlePreHeaderPanelScroll(){this.handleElementScroll(this._preHeaderPanelScroller)}handleTopHeaderPanelScroll(){this.handleElementScroll(this._topHeaderPanelScroller)}handleElementScroll(e){let t=e.scrollLeft;t!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=t)}handleScroll(e){return this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollLeft=this._viewportScrollContainerX.scrollLeft,this._handleScroll(e?"scroll":"system")}_handleScroll(e="system"){let t=this._viewportScrollContainerY.scrollHeight-this._viewportScrollContainerY.clientHeight,i=this._viewportScrollContainerY.scrollWidth-this._viewportScrollContainerY.clientWidth;t=Math.max(0,t),i=Math.max(0,i),this.scrollTop>t&&(this.scrollTop=t,this.scrollHeight=t),this.scrollLeft>i&&(this.scrollLeft=i);let s=Math.abs(this.scrollTop-this.prevScrollTop),o=Math.abs(this.scrollLeft-this.prevScrollLeft);if(o&&(this.prevScrollLeft=this.scrollLeft,this.scrollToX(this.scrollLeft)),s&&!this._options.autoHeight)if(this.vScrollDir=this.prevScrollTop<this.scrollTop?1:-1,this.prevScrollTop=this.scrollTop,e==="mousewheel"&&(this._viewportScrollContainerY.scrollTop=this.scrollTop),this.hasFrozenColumns()&&(this.hasFrozenRows&&!this._options.frozenBottom?this._viewportBottomL.scrollTop=this.scrollTop:this._viewportTopL.scrollTop=this.scrollTop),s<this.viewportH)this.scrollTo(this.scrollTop+this.offset);else{let l=this.offset;this.h===this.viewportH?this.page=0:this.page=Math.min(this.n-1,Math.floor(this.scrollTop*((this.th-this.viewportH)/(this.h-this.viewportH))*(1/this.ph))),this.offset=Math.round(this.page*this.cj),l!==this.offset&&this.invalidateAllRows()}if(o||s){let l=Math.abs(this.lastRenderedScrollLeft-this.scrollLeft),a=Math.abs(this.lastRenderedScrollTop-this.scrollTop);(l>20||a>20)&&(this._options.forceSyncScrolling||a<this.viewportH&&l<this.viewportW?this.render():this.scrollThrottle.enqueue(),this.trigger(this.onViewportChanged,{}))}return this.trigger(this.onScroll,{triggeredBy:e,scrollHeight:this.scrollHeight,scrollLeft:this.scrollLeft,scrollTop:this.scrollTop}),!!(o||s)}scrollCellIntoView(e,t,i){if(this.scrollRowIntoView(e,i),t<=this._options.frozenColumn)return;let s=this.getColspan(e,t);this.internalScrollColumnIntoView(this.columnPosLeft[t],this.columnPosRight[t+(s>1?s-1:0)])}internalScrollColumnIntoView(e,t){let i=this.scrollLeft+r.width(this._viewportScrollContainerX)-(this.viewportHasVScroll?this.scrollbarDimensions?.width??0:0);e<this.scrollLeft?(this._viewportScrollContainerX.scrollLeft=e,this.handleScroll(),this.render()):t>i&&(this._viewportScrollContainerX.scrollLeft=Math.min(e,t-this._viewportScrollContainerX.clientWidth),this.handleScroll(),this.render())}scrollColumnIntoView(e){this.internalScrollColumnIntoView(this.columnPosLeft[e],this.columnPosRight[e])}updatePagingStatusFromView(e){this.pagingActive=e.pageSize!==0,this.pagingIsLastPage=e.pageNum===e.totalPages-1}getRowSpanColumnIntersects(e){return this.getRowSpanIntersection(e,"columns")}getRowSpanIntersect(e){return this.getRowSpanIntersection(e)}getRowSpanIntersection(e,t){let i=[],s=null;for(let o=0,l=this.columns.length;o<l;o++){let a=this._colsWithRowSpanCache[o];if(a)for(let h of Array.from(a)){let[u,d]=h.split(":").map(Number);if(e>=u&&e<=d)if(t==="columns")i.push(o);else{s=u;break}}}return t==="columns"?i:s}getParentRowSpanByCell(e,t,i=!0){let s=null,o=this._colsWithRowSpanCache[t]||new Set;for(let l of Array.from(o)){let[a,h]=l.split(":").map(Number);if((i?e>a:e>=a)&&e<=h){s={start:a,end:h,range:l};break}}return s}remapAllColumnsRowSpan(){let e=this.getDataLength();if(e>0){this._colsWithRowSpanCache={};for(let t=0;t<e;t++)this.remapRowSpanMetadataByRow(t);this._rowSpanIsCached=!0}}remapRowSpanMetadataByRow(e){let t=this.getItemMetadaWhenExists(e);t?.columns&&Object.keys(t.columns).forEach(i=>{let s=+i,o=t.columns[s],l=+(o?.colspan||1),a=+(o?.rowspan||1);this.remapRowSpanMetadata(e,s,l,a)})}remapRowSpanMetadata(e,t,i,s){var o,l,a;if(s>1){let h=`${e}:${e+s-1}`;if((o=this._colsWithRowSpanCache)[t]??(o[t]=new Set),this._colsWithRowSpanCache[t].add(h),i>1)for(let u=1;u<i;u++)(l=this._colsWithRowSpanCache)[a=t+u]??(l[a]=new Set),this._colsWithRowSpanCache[t+u].add(h)}}createEmptyCachingRow(){return{rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]}}scrollRowIntoView(e,t){if(!this.hasFrozenRows||!this._options.frozenBottom&&e>this.actualFrozenRow-1||this._options.frozenBottom&&e<this.actualFrozenRow-1){let i=r.height(this._viewportScrollContainerY),s=this.hasFrozenRows&&!this._options.frozenBottom?e-this._options.frozenRow:e,o=s*this._options.rowHeight,l=(s+1)*this._options.rowHeight-i+(this.viewportHasHScroll?this.scrollbarDimensions?.height??0:0);(s+1)*this._options.rowHeight>this.scrollTop+i+this.offset?(this.scrollTo(t?o:l),this.render()):s*this._options.rowHeight<this.scrollTop+this.offset&&(this.scrollTo(t?l:o),this.render())}}scrollRowToTop(e){this.scrollTo(e*this._options.rowHeight),this.render()}scrollPage(e){let t=e*this.numVisibleRows,i=this.scrollTop+this._options.rowHeight-1;if(this.scrollTo((this.getRowFromPosition(i)+t)*this._options.rowHeight),this.render(),this._options.enableCellNavigation&&r.isDefined(this.activeRow)){let s=this.activeRow+t,o=this.getDataLengthIncludingAddNew();s>=o&&(s=o-1),s<0&&(s=0);let l=e===1?this.gotoDown(s-1||0,this.activeCell,this.activePosY,this.activePosX):this.gotoUp(s+1,this.activeCell,this.activePosY,this.activePosX);this.navigateToPos(l)}}navigatePageDown(){this.scrollPage(1)}navigatePageUp(){this.scrollPage(-1)}navigateTop(){this.unsetActiveCell(),this.navigateToRow(0)}navigateBottom(){let e=this.getDataLength()-1,t=this.getParentRowSpanByCell(e,this.activeCell)?.start??e;do if(this._options.enableCellRowSpan&&this.setActiveRow(t),this.navigateToRow(t)&&this.activeCell===this.activePosX||!r.isDefined(this.activeCell))break;while(--t>0)}navigateToRow(e){let t=this.getDataLength();if(!t)return!1;e<0?e=0:e>=t&&(e=t-1),this.scrollCellIntoView(e,0,!0);let i=!r.isDefined(this.activeCell)||!r.isDefined(this.activeRow);if(this._options.enableCellNavigation&&r.isDefined(this.activeRow)){let s=0,o=null,l=this.activePosX;for(;s<=this.activePosX;)this.canCellBeActive(e,s)&&(o=s,(!r.isDefined(this.activeCell)||s===this.activeCell)&&(i=!0)),s+=this.getColspan(e,s);o!==null?(this.setActiveCellInternal(this.getCellNode(e,o)),this.activePosX=l):this.resetActiveCell()}return i}getColspan(e,t){let i=this.getItemMetadaWhenExists(e);if(!i||!i.columns)return 1;t>=this.columns.length&&(t=this.columns.length-1);let s=(i.columns[this.columns[t].id]||i.columns[t])?.colspan;return s==="*"?s=this.columns.length-t:s=s||1,s}queuePostProcessedRowForCleanup(e,t,i){this.postProcessgroupId++,typeof t=="object"&&Object.keys(t).forEach(s=>{t.hasOwnProperty(s)&&this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e.cellNodesByColumnIdx[+s],columnIdx:+s,rowIdx:i})}),e.rowNode||(e.rowNode=[]),this.postProcessedCleanupQueue.push({actionType:"R",groupId:this.postProcessgroupId,node:e.rowNode}),e.rowNode?.forEach(s=>s.remove())}queuePostProcessedCellForCleanup(e,t,i){this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e,columnIdx:t,rowIdx:i}),e.remove()}applyFormatResultToCellNode(e,t,i){if(e==null&&(e=""),Object.prototype.toString.call(e)!=="[object Object]"){this.applyHtmlCode(t,e);return}let s=e.html||e.text;this.applyHtmlCode(t,s),e.removeClasses&&!i&&t.classList.remove(...r.classNameToList(e.removeClasses)),e.addClasses&&t.classList.add(...r.classNameToList(e.addClasses)),e.toolTip&&t.setAttribute("title",e.toolTip)}startPostProcessing(){this._options.enableAsyncPostRender&&(window.clearTimeout(this.h_postrender),this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}startPostProcessingCleanup(){this._options.enableAsyncPostRenderCleanup&&(window.clearTimeout(this.h_postrenderCleanup),this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay))}invalidatePostProcessingResults(e){typeof this.postProcessedRows[e]=="object"&&Object.keys(this.postProcessedRows[e]).forEach(t=>{this.postProcessedRows[e].hasOwnProperty(t)&&(this.postProcessedRows[e][t]="C")}),this.postProcessFromRow=Math.min(this.postProcessFromRow,e),this.postProcessToRow=Math.max(this.postProcessToRow,e),this.startPostProcessing()}asyncPostProcessRows(){let e=this.getDataLength();for(;this.postProcessFromRow<=this.postProcessToRow;){let t=this.vScrollDir>=0?this.postProcessFromRow++:this.postProcessToRow--,i=this.rowsCache[t];if(!(!i||t>=e)){this.postProcessedRows[t]||(this.postProcessedRows[t]={}),this.ensureCellNodesInRowsCache(t),Object.keys(i.cellNodesByColumnIdx).forEach(s=>{if(i.cellNodesByColumnIdx.hasOwnProperty(s)){let o=+s,l=this.columns[o],a=this.postProcessedRows[t][o];if(l.asyncPostRender&&a!=="R"){let h=i.cellNodesByColumnIdx[o];h&&l.asyncPostRender(h,t,this.getDataItem(t),l,a==="C"),this.postProcessedRows[t][o]="R"}}}),this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay);return}}}asyncPostProcessCleanupRows(){if(this.postProcessedCleanupQueue.length>0){let e=this.postProcessedCleanupQueue[0].groupId;for(;this.postProcessedCleanupQueue.length>0&&this.postProcessedCleanupQueue[0].groupId===e;){let t=this.postProcessedCleanupQueue.shift();if(t?.actionType==="R"&&t.node.forEach(i=>{i.remove()}),t?.actionType==="C"){let i=this.columns[t.columnIdx];i.asyncPostRenderCleanup&&t.node&&i.asyncPostRenderCleanup(t.node,t.rowIdx,i)}}this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay)}}updateCellCssStylesOnRenderedRows(e,t){let i,s,o;typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(l=>{this.rowsCache&&(o=t?.[l],s=e?.[l],o&&Object.keys(o).forEach(a=>{(!s||o[a]!==s[a])&&(i=this.getCellNode(+l,this.getColumnIndex(a)),i&&i.classList.remove(o[a]))}),s&&Object.keys(s).forEach(a=>{(!o||o[a]!==s[a])&&(i=this.getCellNode(+l,this.getColumnIndex(a)),i&&i.classList.add(s[a]))}))})}addCellCssStyles(e,t){if(this.cellCssClasses[e])throw new Error(`SlickGrid addCellCssStyles: cell CSS hash with key "${e}" already exists.`);this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,null),this.trigger(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}removeCellCssStyles(e){this.cellCssClasses[e]&&(this.updateCellCssStylesOnRenderedRows(null,this.cellCssClasses[e]),delete this.cellCssClasses[e],this.trigger(this.onCellCssStylesChanged,{key:e,hash:null,grid:this}))}setCellCssStyles(e,t){let i=this.cellCssClasses[e];this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,i),this.trigger(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}getCellCssStyles(e){return this.cellCssClasses[e]}flashCell(e,t,i=250){let s=(o,l)=>{l<1||(window.clearTimeout(this._flashCellTimer),this._flashCellTimer=window.setTimeout(()=>{l%2===0?o.classList.add(this._options.cellFlashingCssClass||""):o.classList.remove(this._options.cellFlashingCssClass||""),s(o,l-1)},i))};if(this.rowsCache[e]){let o=this.getCellNode(e,t);o&&s(o,5)}}highlightRow(e,t){let i=this.rowsCache[e];t||(t=this._options.rowHighlightDuration),Array.isArray(i?.rowNode)&&this._options.rowHighlightCssClass&&(i.rowNode.forEach(s=>s.classList.add(...r.classNameToList(this._options.rowHighlightCssClass))),window.clearTimeout(this._highlightRowTimer),this._highlightRowTimer=window.setTimeout(()=>{i.rowNode?.forEach(s=>s.classList.remove(...r.classNameToList(this._options.rowHighlightCssClass)))},t))}_getContainerElement(e,t,i){if(!e)return;t||(t=0),i||(i=0);let s=typeof t=="number"?t:this.getColumnIndex(t),o=this.hasFrozenRows&&i>=this.actualFrozenRow+(this._options.frozenBottom?0:1),l=this.hasFrozenColumns()&&s>this._options.frozenColumn;return e[(o?2:0)+(l?1:0)]}measureScrollbar(){let e="";this._viewport.forEach(o=>e+=o.className);let t=r.createDomElement("div",{className:e,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),i=r.createDomElement("div",{style:{width:"200px",height:"200px",overflow:"auto"}},t),s={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight};return i.remove(),t.remove(),s}getMaxSupportedCssHeight(){let e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?this._options.ffMaxSupportedCssHeight:this._options.maxSupportedCssHeight,i=r.createDomElement("div",{style:{display:"hidden"}},document.body);for(;;){let s=e*2;r.height(i,s);let o=r.height(i);if(s>t||o!==s)break;e=s}return i.remove(),e}getUID(){return this.uid}getHeaderColumnWidthDiff(){return this.headerColumnWidthDiff}getScrollbarDimensions(){return this.scrollbarDimensions}getDisplayedScrollbarDimensions(){return{width:this.viewportHasVScroll?this.scrollbarDimensions?.width??0:0,height:this.viewportHasHScroll?this.scrollbarDimensions?.height??0:0}}getAbsoluteColumnMinWidth(){return this.absoluteColumnMinWidth}getVBoxDelta(e){let t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=getComputedStyle(e),s=0;return t.forEach(o=>s+=r.toFloat(i[o])),s}measureCellPaddingAndBorder(){let e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=this._headers[0];this.headerColumnWidthDiff=this.headerColumnHeightDiff=0,this.cellWidthDiff=this.cellHeightDiff=0;let s=r.createDomElement("div",{className:"ui-state-default slick-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},i),o=getComputedStyle(s);o.boxSizing!=="border-box"&&(e.forEach(a=>this.headerColumnWidthDiff+=r.toFloat(o[a])),t.forEach(a=>this.headerColumnHeightDiff+=r.toFloat(o[a]))),s.remove();let l=r.createDomElement("div",{className:"slick-row"},this._canvas[0]);s=r.createDomElement("div",{className:"slick-cell",id:"",style:{visibility:"hidden"},textContent:"-"},l),o=getComputedStyle(s),o.boxSizing!=="border-box"&&(e.forEach(a=>this.cellWidthDiff+=r.toFloat(o[a])),t.forEach(a=>this.cellHeightDiff+=r.toFloat(o[a]))),l.remove(),this.absoluteColumnMinWidth=Math.max(this.headerColumnWidthDiff,this.cellWidthDiff)}clearAllTimers(){window.clearTimeout(this._columnResizeTimer),window.clearTimeout(this._executionBlockTimer),window.clearTimeout(this._flashCellTimer),window.clearTimeout(this._highlightRowTimer),window.clearTimeout(this.h_editorLoader)}LogColWidths(){let e="Col Widths:";for(let t=0;t<this.columns.length;t++)e+=" "+(this.columns[t].hidden?"H":this.columns[t].width);console.log(e)}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.toString()===e.toString()}scrollToX(e){this._viewportScrollContainerX.scrollLeft=e,this._headerScrollContainer.scrollLeft=e,this._topPanelScrollers[0].scrollLeft=e,this._options.createFooterRow&&(this._footerRowScrollContainer.scrollLeft=e),this._options.createPreHeaderPanel&&(this.hasFrozenColumns()?this._preHeaderPanelScrollerR.scrollLeft=e:this._preHeaderPanelScroller.scrollLeft=e),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller.scrollLeft=e),this.hasFrozenColumns()?(this.hasFrozenRows&&(this._viewportTopR.scrollLeft=e),this._headerRowScrollerR.scrollLeft=e):(this.hasFrozenRows&&(this._viewportTopL.scrollLeft=e),this._headerRowScrollerL.scrollLeft=e)}defaultFormatter(e,t,i){return r.isDefined(i)?(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}cellExists(e,t){return!(e<0||e>=this.getDataLength()||t<0||t>=this.columns.length)}getCellFromNode(e){let t=/l\d+/.exec(e.className);if(!t)throw new Error(`SlickGrid getCellFromNode: cannot get cell - ${e.className}`);return parseInt(t[0].substr(1,t[0].length-1),10)}getRowFromNode(e){for(let t in this.rowsCache)if(this.rowsCache){for(let i in this.rowsCache[t].rowNode)if(this.rowsCache[t].rowNode?.[+i]===e)return t?parseInt(t,10):0}return null}clearTextSelection(){if(document.selection?.empty)try{document.selection.empty()}catch{}else if(window.getSelection){let e=window.getSelection();e?.removeAllRanges&&e.removeAllRanges()}}disableSelection(e){e.forEach(t=>{t.setAttribute("unselectable","on"),t.style.mozUserSelect="none",this._bindingEventService.bind(t,"selectstart",()=>!1)})}getPubSubService(){return this._pubSubService}getCellFromPoint(e,t){let i=this.getRowFromPosition(t),s=0,o=0;for(let l=0;l<this.columns.length&&o<=e;l++)this.columns[l]&&(o+=this.columns[l].width,s++);return s-=1,i<-1&&(i=-1),{row:i,cell:s}}getPluginByName(e){for(let t=this.plugins.length-1;t>=0;t--)if(this.plugins[t]?.pluginName===e)return this.plugins[t]}getContainerNode(){return this._container}getCellHeight(e,t){let i=this._options.rowHeight||0;if(t>1){let s=e+t-1;i=this.getRowBottom(s)-this.getRowTop(e)}else{let s=this.getRowHeight();s!==i-this.cellHeightDiff&&(i=s)}return i-=this.cellHeightDiff,Math.ceil(i)}setDifference(e,t){return new Set(Array.from(e).filter(i=>!t.has(i)))}getCellNodeBox(e,t){if(!this.cellExists(e,t))return null;let i=this.getFrozenRowOffset(e),s=this.getRowTop(e)-i,o=s+this._options.rowHeight-1,l=0;for(let h=0;h<t;h++)!this.columns[h]||this.columns[h].hidden||(l+=this.columns[h].width||0,this._options.frozenColumn===h&&(l=0));let a=l+(this.columns[t]?.width||0);return{top:s,left:l,bottom:o,right:a}}absBox(e){let t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:e.offsetWidth,height:e.offsetWidth,visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;let i=e.offsetParent;for(;(e=e.parentNode)!==document.body&&!(!e||!e.parentNode);){let s=getComputedStyle(e);t.visible&&e.scrollHeight!==e.offsetHeight&&s.overflowY!=="visible"&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!==e.offsetWidth&&s.overflowX!=="visible"&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===i&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,i=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width}return t}getActiveCellPosition(){return this.absBox(this.activeCellNode)}getGridPosition(){return this.absBox(this._container)}getCellEditor(){return this.currentEditor}getActiveCell(){return this.activeCellNode?{row:this.activeRow,cell:this.activeCell}:null}getActiveCellNode(){return this.activeCellNode}getTextSelection(){let e=null;if(window.getSelection){let t=window.getSelection();(t?.rangeCount??0)>0&&(e=t.getRangeAt(0))}return e}setTextSelection(e){if(window.getSelection&&e){let t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}}sanitizeHtmlString(e,t){if(!this._options.sanitizer||typeof e!="string")return e;let i=this._options.sanitizer(e);return!t&&this._options.logSanitizedHtml&&this.logMessageCount<=this.logMessageMaxCount&&i!==e&&(console.log(`sanitizer altered html: ${e} --> ${i}`),this.logMessageCount===this.logMessageMaxCount&&console.log(`sanitizer: silencing messages after first ${this.logMessageMaxCount}`),this.logMessageCount++),i}getRowspan(e,t){let i=1,s=this.getItemMetadaWhenExists(e);return s?.columns&&Object.keys(s.columns).forEach(o=>{let l=Number(o);if(l===t){let a=s.columns[l];i=Number(a?.rowspan||1)}}),i}findFocusableRow(e,t,i){let s=e,o=this._colsWithRowSpanCache[t]||new Set,l=!1;return Array.from(o).forEach(a=>{let[h,u]=a.split(":").map(Number);!l&&e>=h&&e<=u&&(s=i==="up"?h:u,this.canCellBeActive(s,t)&&(l=!0))}),s<0&&(s=0),s}findFirstFocusableCell(e){let t=0,i=e,s=-1;for(;t<this.columns.length;){let o=this.getParentRowSpanByCell(e,t);if(i=o!==null&&o.start!==e?o.start:e,this.canCellBeActive(i,t)){s=t;break}t+=this.getColspan(i,t)}return{cell:s,row:i}}findLastFocusableCell(e){let t=0,i=e,s=-1;for(;t<this.columns.length;){let o=this.getParentRowSpanByCell(e,t);i=o!==null&&o.start!==e?o.start:e,this.canCellBeActive(i,t)&&(s=t),t+=this.getColspan(i,t)}return{cell:s,row:i}}rowsToRanges(e){let t=[],i=this.columns.length-1;for(let s=0;s<e.length;s++)t.push(new Qe(e[s],0,e[s],i));return t}findSpanStartingCell(e,t){let i=this.getParentRowSpanByCell(e,t),s=i!==null&&i.start!==e?i.start:e,o=0,l=0;for(;o<this.columns.length;){if(o+=this.getColspan(s,o),o>t)return o=l,{cell:o,row:s};l=o}return{cell:o,row:s}}gotoRight(e,t,i,s){if(t>=this.columns.length)return null;let o=t+1,l=i;do{let a=this.findSpanStartingCell(i,o);if(l=a.row,o=a.cell,this.canCellBeActive(l,o)&&o>t)break;o+=this.getColspan(l,a.cell)}while(o<this.columns.length);return o<this.columns.length?{row:l,cell:o,posX:o,posY:i}:null}gotoLeft(e,t,i,s){if(t<=0)return null;let o=this.findFirstFocusableCell(e);if(o.cell===null||o.cell>=t)return null;let l,a={row:e,cell:o.cell,posX:o.cell,posY:i};for(;;){if(l=this.gotoRight(a.row,a.cell,a.posY,a.posX),!l)return null;if(l.cell>=t){let h=this.findFocusableRow(i,a.cell,"up");return h!==a.row&&(a.row=h),a}a=l}}gotoDown(e,t,i,s){let o,l=this.getDataLengthIncludingAddNew();do for(e+=this.getRowspan(e,s),o=t=0;t<=s;)o=t,t+=this.getColspan(e,t);while(e<=l&&!this.canCellBeActive(e,o));return e<=l?{row:e,cell:o,posX:s,posY:e}:null}gotoUp(e,t,i,s){let o;if(e<=0)return null;do for(e=this.findFocusableRow(e-1,s,"up"),o=t=0;t<=s;)o=t,t+=this.getColspan(e,t);while(e>=0&&!this.canCellBeActive(e,o));return t<=this.columns.length?{row:e,cell:o,posX:s,posY:e}:null}gotoNext(e,t,i,s){if(!r.isDefined(e)&&!r.isDefined(t)&&(e=t=i=s=0,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let o=this.gotoRight(e,t,i,s);if(!o){let l;for(;!o&&++i<this.getDataLength()+(this._options.enableAddRow?1:0);)l=this.findFirstFocusableCell(i),l.cell!==null&&(e=this.getParentRowSpanByCell(i,l.cell)?.start??i,o={row:e,cell:l.cell,posX:l.cell,posY:i})}return o}gotoPrev(e,t,i,s){if(!r.isDefined(e)&&!r.isDefined(t)&&(e=i=this.getDataLengthIncludingAddNew()-1,t=s=this.columns.length-1,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let o=this.gotoLeft(e,t,i,s);if(!o){let l;for(;!o&&--i>=0;)l=this.findLastFocusableCell(i),l.cell>-1&&(e=this.getParentRowSpanByCell(i,l.cell)?.start??i,o={row:e,cell:l.cell,posX:l.cell,posY:i})}return o}gotoRowStart(e,t,i,s){let o=this.findFirstFocusableCell(e);return o.cell===null?null:{row:o.row,cell:o.cell,posX:o.cell,posY:e}}gotoRowEnd(e,t,i,s){let o=this.findLastFocusableCell(e);return o.cell===-1?null:{row:o.row,cell:o.cell,posX:o.cell,posY:e}}navigateRight(){return this.navigate("right")}navigateLeft(){return this.navigate("left")}navigateDown(){return this.navigate("down")}navigateUp(){return this.navigate("up")}navigateNext(){return this.navigate("next")}navigatePrev(){return this.navigate("prev")}navigateRowStart(){return this.navigate("home")}navigateRowEnd(){return this.navigate("end")}navigateTopStart(){return this.navigateToRow(0),this.navigate("home")}navigateBottomEnd(){return this.navigateBottom(),this.navigate("end")}navigate(e){if(!this._options.enableCellNavigation||!this.activeCellNode&&e!=="prev"&&e!=="next")return!1;if(!this.getEditorLock()?.commitCurrentEdit())return!0;this.setFocus(),this.unsetActiveCell();let t={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1};this.tabbingDirection=t[e];let i={up:this.gotoUp,down:this.gotoDown,left:this.gotoLeft,right:this.gotoRight,prev:this.gotoPrev,next:this.gotoNext,home:this.gotoRowStart,end:this.gotoRowEnd}[e].call(this,this.activeRow,this.activeCell,this.activePosY,this.activePosX);return this.navigateToPos(i)}navigateToPos(e){if(e){if(this.hasFrozenRows&&this._options.frozenBottom&&e.row===this.getDataLength())return;let t=e.row===this.getDataLength();return(!this._options.frozenBottom&&e.row>=this.actualFrozenRow||this._options.frozenBottom&&e.row<this.actualFrozenRow)&&this.scrollCellIntoView(e.row,e.cell,!t&&this._options.emulatePagingWhenScrolling),this.setActiveCellInternal(this.getCellNode(e.row,e.cell)),this.activePosX=e.posX,this.activePosY=e.posY,!0}else return this.setActiveCellInternal(this.getCellNode(this.activeRow,this.activeCell)),!1}getCellNode(e,t){if(this.rowsCache[e]){this.ensureCellNodesInRowsCache(e);try{return this.rowsCache[e].cellNodesByColumnIdx.length>t?this.rowsCache[e].cellNodesByColumnIdx[t]:null}catch{return this.rowsCache[e].cellNodesByColumnIdx[t]}}return null}setActiveCell(e,t,i,s,o){this.initialized&&(e>this.getDataLength()||e<0||t>=this.columns.length||t<0||this._options.enableCellNavigation&&(this.scrollCellIntoView(e,t,!1),this.setActiveCellInternal(this.getCellNode(e,t),i,s,o)))}setActiveRow(e,t,i){this.initialized&&(e>this.getDataLength()||e<0||(t??0)>=this.columns.length||(t??0)<0||(this.activeRow=e,i||this.scrollCellIntoView(e,t||0,!1)))}canCellBeActive(e,t){if(!this._options.enableCellNavigation||e>=this.getDataLengthIncludingAddNew()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden||(this.getParentRowSpanByCell(e,t)?.start??e)!==e)return!1;let i=this.getItemMetadaWhenExists(e);if(i?.focusable!==void 0)return!!i.focusable;let s=i?.columns;return s?.[this.columns[t].id]?.focusable!==void 0?!!s[this.columns[t].id].focusable:s?.[t]?.focusable!==void 0?!!s[t].focusable:!!this.columns[t].focusable}canCellBeSelected(e,t){if(e>=this.getDataLength()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden)return!1;let i=this.getItemMetadaWhenExists(e);if(i?.selectable!==void 0)return!!i.selectable;let s=i?.columns&&(i.columns[this.columns[t].id]||i.columns[t]);return s?.selectable!==void 0?!!s.selectable:!!this.columns[t].selectable}gotoCell(e,t,i,s){if(!this.initialized||!this.canCellBeActive(e,t)||!this.getEditorLock()?.commitCurrentEdit())return;this.scrollCellIntoView(e,t,!1);let o=this.getCellNode(e,t),l=this.columns[t],a=!!(this._options.editable&&l?.editor&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(o,i||e===this.getDataLength()||this._options.autoEdit,null,a,s),this.currentEditor||this.setFocus()}};oe.ScriptBasePath="/Scripts/";function it(e){return"Dispose"in e}function st(){return ot()}function ot(){let e,t,i,s,o,l,a,h=[(e={id:"title",field:"title"},e.name="Title",e.sortable=!0,e.width=200,e),(t={id:"duration",field:"duration"},t.name="Duration",t.sortable=!0,t),(i={id:"percentComplete",field:"percentComplete"},i.name="% Complete",i.formatter=Q.PercentCompleteBar,i.width=250,i),(s={id:"start",field:"start"},s.name="Start",s),(o={id:"finish",field:"finish"},o.name="Finish",o),(l={id:"effortDriven",field:"effortDriven"},l.name="Effort Driven",l.formatter=Q.Checkmark,l.cssClass="text-center",l)],u=(a={},a.enableCellNavigation=!0,a.enableColumnReorder=!1,a.rowHeight=35,a),d=ct(lt(()=>nt(p=>({id:p,title:"Task "+String(p),duration:"5 days",percentComplete:Math.round(Math.random()*100),start:"01/01/2024",finish:"01/05/2024",effortDriven:p%5===0}),dt(0,499))));return new ge("#myGrid",d,h,u)}function lt(e){return{GetEnumerator:()=>U(e())}}function nt(e,t){return{GetEnumerator:()=>{let i=U(t);return new T(null,null,s=>i.MoveNext()&&(s.c=e(i.Current),!0),()=>{i.Dispose()})}}}function rt(e,t){return at(e,ht(t))}function at(e,t){return e<0&&Ct(),{GetEnumerator:()=>{let i=[U(t)];return new T(0,null,s=>{if(s.s=s.s+1,s.s>e)return!1;{let o=i[0];return V(o,null)?_e():o.MoveNext()?(s.c=o.Current,s.s===e&&(o.Dispose(),i[0]=null),!0):(o.Dispose(),i[0]=null,_e())}},()=>{let s=i[0];V(s,null)||s.Dispose()})}}}function ht(e){return{GetEnumerator:()=>new T(0,null,t=>(t.c=e(t.s),t.s=t.s+1,!0),void 0)}}function dt(e,t){let i=1+t-e;return i<=0?[]:rt(i,s=>s+e)}function F(e){throw new Error(e)}function ct(e){if(e instanceof Array)return e.slice();if(e instanceof te)return ut(e);{let t=[],i=U(e);try{for(;i.MoveNext();)t.push(i.Current);return t}finally{let s=i;typeof s=="object"&&it(s)&&i.Dispose()}}}function ut(e){let t=[],i=e;for(;i.$!=0;)t.push(_t(i)),i=wt(i);return t}function U(e){return e instanceof Array?pt(e):V(typeof e,"string")?mt(e):e.GetEnumerator()}function pt(e){return new T(0,null,t=>{let i=t.s;return i<G(e)&&(t.c=ee(e,i),t.s=i+1,!0)},void 0)}function mt(e){return new T(0,null,t=>{let i=t.s;return i<e.length&&(t.c=e[i],t.s=i+1,!0)},void 0)}var J=class{Equals(t){return this===t}},T=class extends J{s;c;n;d;e;Dispose(){this.d&&this.d(this)}MoveNext(){let t=this.n(this);return this.e=t?1:2,t}get Current(){return this.e===1?this.c:this.e===0?F("Enumeration has not started. Call MoveNext."):F("Enumeration already finished.")}constructor(t,i,s,o){super(),this.s=t,this.c=i,this.n=s,this.d=o,this.e=0}};function ee(e,t){return gt(e,t),e[t]}function G(e){return e.dims===2?e.length*e.length:e.length}function gt(e,t){(t<0||t>=e.length)&&F("Index was outside the bounds of the array.")}var te=class{GetEnumerator(){return new T(this,null,t=>{let i=t.s;if(i.$==0)return!1;{let s=i.$1;return t.c=i.$0,t.s=s,!0}},void 0)}$;$0;$1};function V(e,t){if(e===t)return!0;{let o=typeof e;if(o=="object"){if(e==null||t===null||t===void 0||!V(typeof t,"object"))return!1;if("Equals"in e)return e.Equals(t);if("Equals"in t)return!1;if(e instanceof Array&&t instanceof Array)return fe(e,t);if(e instanceof Date&&t instanceof Date)return ft(e,t);{let l=e,a=t,h=[!0],u;for(var i in l)if((d=>(h[0]=!l.hasOwnProperty(d)||a.hasOwnProperty(d)&&V(l[d],a[d]),!h[0]))(i))break;if(h[0]){let d;for(var s in a)if((p=>(h[0]=!a.hasOwnProperty(p)||l.hasOwnProperty(p),!h[0]))(s))break}return h[0]}}else return o=="function"&&("$Func"in e?e.$Func===t.$Func&&e.$Target===t.$Target:"$Invokes"in e&&"$Invokes"in t&&fe(e.$Invokes,t.$Invokes))}}function fe(e,t){let i,s;if(G(e)===G(t)){for(i=!0,s=0;i&&s<G(e);)V(ee(e,s),ee(t,s))||(i=!1),s=s+1;return i}else return!1}function ft(e,t){return e.getTime()===t.getTime()}function _t(e){return e.$==1?e.$0:we()}function wt(e){return e.$==1?e.$1:we()}function we(){return F("The input list was empty.")}function Ct(){return F("The input must be non-negative.")}function _e(){return F("The input sequence has an insufficient number of elements.")}st();})();
/*! Bundled license information:

slickgrid/dist/esm/index.mjs:
  (**
   * @license
   * (c) 2009-present Michael Leibman
   * michael{dot}leibman{at}gmail{dot}com
   * http://github.com/mleibman/slickgrid
   *
   * Distributed under MIT license.
   * All rights reserved.
   *
   * SlickGrid v5.18.0
   *
   * NOTES:
   *     Cell/row DOM manipulations are done directly bypassing JS DOM manipulation methods.
   *     This increases the speed dramatically, but can only be done safely because there are no event handlers
   *     or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()
   *     and do proper cleanup.
   *)
*/
